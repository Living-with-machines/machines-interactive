// @observablehq/plot v0.5.2 Copyright 2020-2022 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.6.1/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.6.1/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n({document:t=window.document}={}){return{document:t}}function r(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}function i(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return`${s=t.getUTCFullYear(),s<0?`-${o(-s,6)}`:s>9999?`+${o(s,6)}`:o(s,4)}-${o(t.getUTCMonth()+1,2)}-${o(t.getUTCDate(),2)}${n||r||i||a?`T${o(n,2)}:${o(r,2)}${i||a?`:${o(i,2)}${a?`.${o(a,3)}`:""}`:""}Z`:""}`;var s}function o(t,e){return`${t}`.padStart(e,"0")}const a=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function s(t,e){return a.test(t+="")?new Date(t):"function"==typeof e?e(t):e}const l=Object.getPrototypeOf(Uint8Array),c=Object.prototype.toString;function u(t,e,n){const r=typeof e;return"string"===r?O(t,f(e),n):"function"===r?O(t,e,n):"number"===r||e instanceof Date||"boolean"===r?O(t,b(e),n):e&&"function"==typeof e.transform?z(e.transform(t),n):z(e,n)}const f=t=>e=>e[t],h=(t,e)=>e,d={transform:t=>t},p=()=>1,m=()=>!0,g=t=>null==t?t:`${t}`,y=t=>null==t?t:+t,v=t=>null==t?t:!!t,x=t=>t?t[0]:void 0,w=t=>t?t[1]:void 0,b=t=>()=>t;function k(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function $(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:nt(t)?[void 0,t]:[t,void 0]}function M(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function L(t,e,n){if(null!=t)return A(t,e,n)}function A(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function z(t,e){return null==t?t:void 0===e?t instanceof Array||t instanceof l?t:Array.from(t):t instanceof e?t:e.from(t)}function O(t,e,n=Array){return t instanceof n?t.map(e):n.from(t,e)}function R(t,e=Array){return t instanceof e?t.slice():e.from(t)}function B(t){return t instanceof l}function C(t){return t?.toString===c}function E(t){return C(t)&&(void 0!==t.type||void 0!==t.domain)}function P(t){return C(t)&&"function"!=typeof t.transform}function S(t){return P(t)&&void 0===t.value&&void 0===t.channel}function N(t,e,n,r=d){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function T(t,e){return void 0===t&&void 0===e?[x,w]:[t,e]}function D({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=$(e)),void 0===t&&([t]=$(n)),t}function q(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function W(t,e){return q(t).filter((n=>e(t[n],n,t)))}function Y(t,e){return O(e,(e=>t[e]))}function _(t){return null!==t&&"object"==typeof t?t.valueOf():t}function j(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function F(t){let e;return[{transform:()=>e,label:G(t)},t=>e=t]}function I(t){return null==t?[t]:F(t)}function G(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function X(t,e){return{transform(n){const r=t.transform(n),i=e.transform(n);return Q(r)||Q(i)?O(r,((t,e)=>new Date((+r[e]+ +i[e])/2))):O(r,((t,e)=>(+r[e]+ +i[e])/2),Float64Array)},label:t.label}}function U(t){return void 0===t||P(t)?t:{value:t}}function V(t){return t&&"function"==typeof t[Symbol.iterator]}function H(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function Z(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function Q(t){for(const e of t)if(null!=e)return e instanceof Date}function J(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&s(e)}function K(t){for(const e of t)if(null!=e&&""!==e)return"string"==typeof e&&!isNaN(e)}function tt(t,e){for(const n of t)if(null!=n)return e(n)}function et(t,e){for(const n of t)if(null!=n&&!e(n))return!1;return!0}function nt(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==e.color(t))}function rt(t){return null==t||it(t)}function it(t){return/^\s*none\s*$/i.test(t)}function ot(t="middle"){return A(t,"frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function at(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}function st(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const lt=st((t=>new Intl.NumberFormat(t))),ct=st(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",month:e}))),ut=st(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",weekday:e})));function ft(t){return i(t,"Invalid Date")}const ht=function(t="en-US"){const e=function(t="en-US"){const e=lt(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?ft:"number"==typeof t?e:g)(t)}(),dt=Math.PI/180;function pt(t){return null!=t&&!Number.isNaN(t)}function mt(t,n){return+pt(n)-+pt(t)||e.ascending(t,n)}function gt(t,n){return+pt(n)-+pt(t)||e.descending(t,n)}function yt(t){return null!=t&&""!=`${t}`}function vt(t){return isFinite(t)?t:NaN}function xt(t){return t>0&&isFinite(t)?t:NaN}function wt(t){return t<0&&isFinite(t)?t:NaN}let bt=0;function kt(t){console.warn(t),++bt}const $t="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5;let Mt=0;function Lt(t,{title:e,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:a,fill:s,fillOpacity:l,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:v,mixBlendMode:x,paintOrder:w,pointerEvents:b,shapeRendering:k},{ariaLabel:L,fill:A="currentColor",fillOpacity:z,stroke:O="none",strokeOpacity:R,strokeWidth:B,strokeLinecap:C,strokeLinejoin:E,strokeMiterlimit:P,paintOrder:S}){null===A&&(s=null,l=null),null===O&&(c=null,f=null),rt(A)?rt(O)||rt(s)||(O="none"):rt(O)&&!rt(c)&&(A="none");const[N,T]=$(s,A),[D,q]=M(l,z),[W,Y]=$(c,O),[_,j]=M(f,R),[F,I]=M(v);it(Y)||(void 0===u&&(u=B),void 0===d&&(d=C),void 0===h&&(h=E),void 0!==p||/^\s*round\s*$/i.test(h)||(p=P),it(T)||void 0!==w||(w=S));const[G,X]=M(u);return null!==A&&(t.fill=Dt(T,"currentColor"),t.fillOpacity=qt(q,1)),null!==O&&(t.stroke=Dt(Y,"none"),t.strokeWidth=qt(X,1),t.strokeOpacity=qt(j,1),t.strokeLinejoin=Dt(h,"miter"),t.strokeLinecap=Dt(d,"butt"),t.strokeMiterlimit=qt(p,4),t.strokeDasharray=Dt(m,"none"),t.strokeDashoffset=Dt(y,"0")),t.target=g(a),t.ariaLabel=g(L),t.ariaDescription=g(i),t.ariaHidden=g(o),t.opacity=qt(I,1),t.mixBlendMode=Dt(x,"normal"),t.paintOrder=Dt(w,"normal"),t.pointerEvents=Dt(b,"auto"),t.shapeRendering=Dt(k,"auto"),[{name:"title",value:e,optional:!0},{name:"href",value:n,optional:!0},{name:"ariaLabel",value:r,optional:!0},{name:"fill",value:N,scale:"color",optional:!0},{name:"fillOpacity",value:D,scale:"opacity",optional:!0},{name:"stroke",value:W,scale:"color",optional:!0},{name:"strokeOpacity",value:_,scale:"opacity",optional:!0},{name:"strokeWidth",value:G,optional:!0},{name:"opacity",value:F,scale:"opacity",optional:!0}]}function At(t,e){e&&t.text((t=>ht(e[t])))}function zt(t,e){e&&t.text((([t])=>ht(e[t])))}function Ot(t,{target:e},{ariaLabel:n,title:r,fill:i,fillOpacity:o,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&Nt(t,"aria-label",(t=>n[t])),i&&Nt(t,"fill",(t=>i[t])),o&&Nt(t,"fill-opacity",(t=>o[t])),a&&Nt(t,"stroke",(t=>a[t])),s&&Nt(t,"stroke-opacity",(t=>s[t])),l&&Nt(t,"stroke-width",(t=>l[t])),c&&Nt(t,"opacity",(t=>c[t])),u&&St(t,(t=>u[t]),e),function(t,e){e&&t.filter((t=>yt(e[t]))).append("title").call(At,e)}(t,r)}function Rt(t,{target:e},{ariaLabel:n,title:r,fill:i,fillOpacity:o,stroke:a,strokeOpacity:s,strokeWidth:l,opacity:c,href:u}){n&&Nt(t,"aria-label",(([t])=>n[t])),i&&Nt(t,"fill",(([t])=>i[t])),o&&Nt(t,"fill-opacity",(([t])=>o[t])),a&&Nt(t,"stroke",(([t])=>a[t])),s&&Nt(t,"stroke-opacity",(([t])=>s[t])),l&&Nt(t,"stroke-width",(([t])=>l[t])),c&&Nt(t,"opacity",(([t])=>c[t])),u&&St(t,(([t])=>u[t]),e),function(t,e){e&&t.filter((([t])=>yt(e[t]))).append("title").call(zt,e)}(t,r)}function Bt(t,n,r){const i=e.group(t,(t=>n[t]));return void 0===r&&i.size>t.length>>1&&kt("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),i.values()}function*Ct(t,e,{z:n},r){const{z:i}=r,o=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:i,strokeOpacity:o,strokeWidth:a,opacity:s,href:l}){return[t,e,n,r,i,o,a,s,l].filter((t=>void 0!==t))}(r),a=[...e,...o];for(const e of i?Bt(t,i,n):[t]){let t,n;t:for(const r of e){for(const t of a)if(!pt(t[r])){n&&n.push(-1);continue t}if(void 0!==t){n.push(r);for(let e=0;e<o.length;++e){if(_(o[e][r])!==t[e]){yield n,t=o.map((t=>_(t[r]))),n=[r];continue t}}}else n&&(yield n),t=o.map((t=>_(t[r]))),n=[r]}n&&(yield n)}}function Et(t,e,n,r){if(Nt(t,"aria-label",e.ariaLabel),Nt(t,"aria-description",e.ariaDescription),Nt(t,"aria-hidden",e.ariaHidden),Nt(t,"fill",e.fill),Nt(t,"fill-opacity",e.fillOpacity),Nt(t,"stroke",e.stroke),Nt(t,"stroke-width",e.strokeWidth),Nt(t,"stroke-opacity",e.strokeOpacity),Nt(t,"stroke-linejoin",e.strokeLinejoin),Nt(t,"stroke-linecap",e.strokeLinecap),Nt(t,"stroke-miterlimit",e.strokeMiterlimit),Nt(t,"stroke-dasharray",e.strokeDasharray),Nt(t,"stroke-dashoffset",e.strokeDashoffset),Nt(t,"shape-rendering",e.shapeRendering),Nt(t,"paint-order",e.paintOrder),Nt(t,"pointer-events",e.pointerEvents),"frame"===e.clip){const{x:e,y:i}=n,{width:o,height:a,marginLeft:s,marginRight:l,marginTop:c,marginBottom:u}=r,f="plot-clip-"+ ++Mt;t.attr("clip-path",`url(#${f})`).append("clipPath").attr("id",f).append("rect").attr("x",s-(e?.bandwidth?e.bandwidth()/2:0)).attr("y",c-(i?.bandwidth?i.bandwidth()/2:0)).attr("width",o-l-s).attr("height",a-c-u)}}function Pt(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),Nt(t,"opacity",e.opacity)}function St(t,n,r){t.each((function(t){const i=n(t);if(null!=i){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",i),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Nt(t,e,n){null!=n&&t.attr(e,n)}function Tt(t,e,{x:n,y:r},i=$t,o=$t){i+=e.dx,o+=e.dy,n?.bandwidth&&(i+=n.bandwidth()/2),r?.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&t.attr("transform",`translate(${i},${o})`)}function Dt(t,e){if((t=g(t))!==e)return t}function qt(t,e){if((t=y(t))!==e)return t}const Wt=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function Yt(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!Wt.test(t))throw new Error(`invalid class name: ${t}`);return t}function _t(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function jt({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-i:(a+e-i)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-o:(r+n-o)/2]}class Ft{constructor({name:t="x",axis:e,ticks:n,tickSize:r=("fx"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:c,labelOffset:u,line:f,tickRotate:h,ariaLabel:d,ariaDescription:p}={}){this.name=t,this.axis=A(e,"axis",["top","bottom"]),this.ticks=Xt(n),this.tickSize=y(r),this.tickPadding=y(i),this.tickFormat=Ut(o),this.fontVariant=Dt(a,"normal"),this.grid=v(s),this.label=g(l),this.labelAnchor=L(c,"labelAnchor",["center","left","right"]),this.labelOffset=y(u),this.line=v(f),this.tickRotate=y(h),this.ariaLabel=g(d),this.ariaDescription=g(p)}render(t,{[this.name]:n,fy:i},{width:o,height:a,marginTop:s,marginRight:l,marginBottom:c,marginLeft:u,offsetLeft:f=0,facetMarginTop:h,facetMarginBottom:d,labelMarginLeft:p=0,labelMarginRight:m=0},g){const{axis:y,fontVariant:v,grid:x,label:w,labelAnchor:b,labelOffset:k,line:$,name:M,tickRotate:L}=this,A="top"===y?-1:1,z=A*("x"===M?0:"top"===y?s-h:c-d)+("top"===y?s:a-c);return r("svg:g",g).call(Gt,this).attr("transform",`translate(${f},${z})`).call(Ht("top"===y?e.axisTop:e.axisBottom,n,this)).call(Zt,L).attr("font-size",null).attr("font-family",null).attr("font-variant",v).call($?()=>{}:t=>t.select(".domain").remove()).call(x?i?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?Y(i,t):i).map((t=>`M0,${e(t)+n}v${r}`)).join(""))}(t,i,-z):(O=A*(c+s-a),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("y2",O)):()=>{}).call(w?t=>t.append("text").attr("fill","currentColor").attr("transform",`translate(${"center"===b?(o+u-l)/2:"right"===b?o+m:-p},${k*A})`).attr("dy","top"===y?"1em":"-0.32em").attr("text-anchor","center"===b?"middle":"right"===b?"end":"start").text(w):()=>{}).node();var O}}class It{constructor({name:t="y",axis:e,ticks:n,tickSize:r=("fy"===t?0:6),tickPadding:i=(0===r?9:3),tickFormat:o,fontVariant:a,grid:s,label:l,labelAnchor:c,labelOffset:u,line:f,tickRotate:h,ariaLabel:d,ariaDescription:p}={}){this.name=t,this.axis=A(e,"axis",["left","right"]),this.ticks=Xt(n),this.tickSize=y(r),this.tickPadding=y(i),this.tickFormat=Ut(o),this.fontVariant=Dt(a,"normal"),this.grid=v(s),this.label=g(l),this.labelAnchor=L(c,"labelAnchor",["center","top","bottom"]),this.labelOffset=y(u),this.line=v(f),this.tickRotate=y(h),this.ariaLabel=g(d),this.ariaDescription=g(p)}render(t,{[this.name]:n,fx:i},{width:o,height:a,marginTop:s,marginRight:l,marginBottom:c,marginLeft:u,offsetTop:f=0,facetMarginLeft:h,facetMarginRight:d},p){const{axis:m,fontVariant:g,grid:y,label:v,labelAnchor:x,labelOffset:w,line:b,name:k,tickRotate:$}=this,M="left"===m?-1:1,L=M*("y"===k?0:"left"===m?u-h:l-d)+("right"===m?o-l:u);return r("svg:g",p).call(Gt,this).attr("transform",`translate(${L},${f})`).call(Ht("right"===m?e.axisRight:e.axisLeft,n,this)).call(Zt,$).attr("font-size",null).attr("font-family",null).attr("font-variant",g).call(b?()=>{}:t=>t.select(".domain").remove()).call(y?i?function(t,e,n){const r=e.bandwidth(),i=e.domain();return o=>o.selectAll(".tick").append("path").attr("stroke","currentColor").attr("stroke-opacity",.1).attr("d",(t?Y(i,t):i).map((t=>`M${e(t)+n},0h${r}`)).join(""))}(t,i,-L):(A=M*(u+l-o),t=>t.selectAll(".tick line").clone(!0).attr("stroke-opacity",.1).attr("x2",A)):()=>{}).call(v?t=>t.append("text").attr("fill","currentColor").attr("font-variant",null==g?null:"normal").attr("transform",`translate(${w*M},${"center"===x?(a+s-c)/2:"bottom"===x?a-c:s})${"center"===x?" rotate(-90)":""}`).attr("dy","center"===x?"right"===m?"-0.32em":"0.75em":"bottom"===x?"1.4em":"-1em").attr("text-anchor","center"===x?"middle":"right"===m?"end":"start").text(v):()=>{}).node();var A}}function Gt(t,{name:e,label:n,ariaLabel:r=`${e}-axis`,ariaDescription:i=n}){Nt(t,"aria-label",r),Nt(t,"aria-description",i)}function Xt(t){return null===t?[]:t}function Ut(t){return null===t?()=>null:t}function Vt(t,n){return void 0===t?Q(n)?ft:g:"function"==typeof t?t:("string"==typeof t?Q(n)?e.utcFormat:e.format:b)(t)}function Ht(t,e,{ticks:n,tickSize:r,tickPadding:i,tickFormat:o}){return e.tickFormat||(o=Vt(o,e.domain())),t(e).ticks(Array.isArray(n)?null:n,"function"==typeof o?null:o).tickFormat("function"==typeof o?o:null).tickSizeInner(r).tickSizeOuter(0).tickPadding(i).tickValues(Array.isArray(n)?n:null)}function Zt(t,e){if(e=+e)for(const n of t.selectAll("text")){const t=+n.getAttribute("x"),r=+n.getAttribute("y");if(Math.abs(r)>Math.abs(t)){const t=Math.sign(r);n.setAttribute("transform",`translate(0, ${r+4*t*Math.cos(e*dt)}) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)<10?"middle":e<0^t>0?"start":"end")}else{const r=Math.sign(t);n.setAttribute("transform",`translate(${t+4*r*Math.abs(Math.sin(e*dt))}, 0) rotate(${e})`),n.setAttribute("text-anchor",Math.abs(e)>60?"middle":r>0?"start":"end")}n.removeAttribute("x"),n.removeAttribute("y"),n.setAttribute("dy","0.32em")}}const Qt=Symbol("position"),Jt=Symbol("color"),Kt=Symbol("radius"),te=Symbol("length"),ee=Symbol("opacity"),ne=Symbol("symbol"),re=new Map([["x",Qt],["y",Qt],["fx",Qt],["fy",Qt],["r",Kt],["color",Jt],["opacity",ee],["symbol",ne],["length",te]]),ie=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10],["brbg",ae(e.schemeBrBG,e.interpolateBrBG)],["prgn",ae(e.schemePRGn,e.interpolatePRGn)],["piyg",ae(e.schemePiYG,e.interpolatePiYG)],["puor",ae(e.schemePuOr,e.interpolatePuOr)],["rdbu",ae(e.schemeRdBu,e.interpolateRdBu)],["rdgy",ae(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",ae(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",ae(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",ae(e.schemeSpectral,e.interpolateSpectral)],["burd",se(e.schemeRdBu,e.interpolateRdBu)],["buylrd",se(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",oe(e.schemeBlues,e.interpolateBlues)],["greens",oe(e.schemeGreens,e.interpolateGreens)],["greys",oe(e.schemeGreys,e.interpolateGreys)],["oranges",oe(e.schemeOranges,e.interpolateOranges)],["purples",oe(e.schemePurples,e.interpolatePurples)],["reds",oe(e.schemeReds,e.interpolateReds)],["turbo",le(e.interpolateTurbo)],["viridis",le(e.interpolateViridis)],["magma",le(e.interpolateMagma)],["inferno",le(e.interpolateInferno)],["plasma",le(e.interpolatePlasma)],["cividis",le(e.interpolateCividis)],["cubehelix",le(e.interpolateCubehelixDefault)],["warm",le(e.interpolateWarm)],["cool",le(e.interpolateCool)],["bugn",oe(e.schemeBuGn,e.interpolateBuGn)],["bupu",oe(e.schemeBuPu,e.interpolateBuPu)],["gnbu",oe(e.schemeGnBu,e.interpolateGnBu)],["orrd",oe(e.schemeOrRd,e.interpolateOrRd)],["pubu",oe(e.schemePuBu,e.interpolatePuBu)],["pubugn",oe(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",oe(e.schemePuRd,e.interpolatePuRd)],["rdpu",oe(e.schemeRdPu,e.interpolateRdPu)],["ylgn",oe(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",oe(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",oe(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",oe(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",ce(e.interpolateRainbow)],["sinebow",ce(e.interpolateSinebow)]]);function oe(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function ae(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function se(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function le(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function ce(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function ue(t){const e=`${t}`.toLowerCase();if(!ie.has(e))throw new Error(`unknown scheme: ${e}`);return ie.get(e)}function fe(t,e){const n=ue(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const he=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function de(t){const e=`${t}`.toLowerCase();if(!he.has(e))throw new Error(`unknown scheme: ${e}`);return he.get(e)}const pe=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function me(t){return null!=t&&pe.has(`${t}`.toLowerCase())}function ge({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=ve(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function ye({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=ve(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function ve(t,e,n){return void 0===t&&void 0===e&&void 0===n?$t?[1,0]:[.5,.5]:[e,n]}function xe(t){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>n*t))}}if("function"!=typeof t.floor||"function"!=typeof t.offset)throw new Error("invalid interval; missing floor or offset function");return t}}function we(t,{interval:e}){return(t={...U(t)}).interval=xe(void 0===t.interval?e:t.interval),t}function be(t,e,n,r){const{[t]:i,[`${t}1`]:o,[`${t}2`]:a}=n,{value:s,interval:l}=we(i,n);if(null==s||null==l&&!r)return n;const c=G(i);if(null==l){let e;const r={transform:t=>e||(e=u(t,s)),label:c};return{...n,[t]:void 0,[`${t}1`]:void 0===o?r:o,[`${t}2`]:void 0===a?r:a}}let f,h;function d(t){return void 0!==h&&t===f?h:h=O(u(f=t,s),(t=>l.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===o?{transform:d,label:c}:o,[`${t}2`]:void 0===a?{transform:t=>d(t).map((t=>l.offset(t))),label:c}:a})}function ke(t,e,n){const{[t]:r}=n,{value:i,interval:o}=we(r,n);return null==i||null==o?n:e({...n,[t]:{label:G(r),transform:t=>{const e=O(u(t,i),(t=>o.floor(t))),n=e.map((t=>o.offset(t)));return e.map(Q(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function $e(t={}){return be("x",ge,t,!0)}function Me(t={}){return be("y",ye,t,!0)}function Le(t={}){return be("x",ge,t)}function Ae(t={}){return be("y",ye,t)}function ze(t={}){return ke("x",ge,t)}function Oe(t={}){return ke("y",ye,t)}const Re=t=>e=>t(1-e),Be=[0,1],Ce=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function Ee(t){const e=`${t}`.toLowerCase();if(!Ce.has(e))throw new Error(`unknown interpolator: ${e}`);return Ce.get(e)}function Pe(t,n,r,{type:i,nice:o,clamp:a,zero:s,domain:l=De(t,r),unknown:c,round:u,scheme:f,interval:h,range:d=(re.get(t)===Kt?We(r,l):re.get(t)===te?Ye(r,l):re.get(t)===ee?Be:void 0),interpolate:p=(re.get(t)===Jt?null==f&&void 0!==d?e.interpolateRgb:de(void 0!==f?f:"cyclical"===i?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:m}){if(h=xe(h),"cyclical"!==i&&"sequential"!==i||(i="linear"),m=!!m,"function"!=typeof p&&(p=Ee(p)),1===p.length?(m&&(p=Re(p),m=!1),void 0===d&&2===(d=Float64Array.from(l,((t,e)=>e/(l.length-1)))).length&&(d=Be),n.interpolate((d===Be?b:Fe)(p))):n.interpolate(p),s){const[t,n]=e.extent(l);(t>0||n<0)&&(at(l=R(l))!==Math.sign(t)?l[l.length-1]=0:l[0]=0)}return m&&(l=e.reverse(l)),n.domain(l).unknown(c),o&&(n.nice(!0===o?void 0:o),l=n.domain()),void 0!==d&&n.range(d),a&&n.clamp(a),{type:i,domain:l,range:d,scale:n,interpolate:p,interval:h}}function Se(t,n,{exponent:r=1,...i}){return Pe(t,e.scalePow().exponent(r),n,{...i,type:"pow"})}function Ne(t,n,{domain:r=[0],unknown:i,scheme:o="rdylbu",interpolate:a,range:s=(void 0!==a?e.quantize(a,r.length+1):re.get(t)===Jt?fe(o,r.length+1):void 0),reverse:l}){const c=at(z(r));if(!e.pairs(r).every((([t,n])=>function(t,n,r){const i=e.descending(t,n);return 0===i||i===r}(t,n,c))))throw new Error(`the ${t} scale has a non-monotonic domain`);return l&&(s=e.reverse(s)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===s?[]:s).unknown(i),domain:r,range:s}}function Te(t,n=vt){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function De(t,e){const n=re.get(t);return(n===Kt||n===ee||n===te?qe:Te)(e)}function qe(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,vt))):1]}function We(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const i=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,xt))),o=n.map((t=>3*Math.sqrt(t/i))),a=30/e.max(o);return a<1?o.map((t=>t*a)):o}function Ye(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),i=n.map((t=>12*t/r)),o=60/e.max(i);return o<1?i.map((t=>t*o)):i}function _e(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n=+n,n>0)return Te(t,xt);if(n<0)return Te(t,wt)}return[1,10]}function je(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function Fe(t){return(e,n)=>r=>t(e+r*(n-e))}function Ie(t,n,r,i,{type:o,nice:a,clamp:s,domain:l=Te(i),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(re.get(t)===Jt?null==f&&void 0!==h?e.interpolateRgb:de(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u;let[g,y]=l;if(g=Math.min(g,u),y=Math.max(y,u),"function"!=typeof p&&(p=Ee(p)),void 0!==h&&(p=1===p.length?Fe(p)(...h):e.piecewise(p,h)),m&&(p=Re(p)),d){const t=r.apply(u),e=t-r.apply(g),n=r.apply(y)-t;e<n?g=r.invert(t-n):e>n&&(y=r.invert(t+e))}return n.domain([g,u,y]).unknown(c).interpolator(p),s&&n.clamp(s),a&&n.nice(a),{type:o,domain:[g,y],pivot:u,interpolate:p,scale:n}}function Ge(t,n,{exponent:r=1,...i}){return Ie(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?He:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...i,type:"diverging-pow"})}function Xe(t,n,{constant:r=1,...i}){return Ie(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,i)}const Ue={apply:t=>t,invert:t=>t},Ve={apply:Math.log,invert:Math.exp},He={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Ze(t,e,n,r){return Pe(t,e,n,r)}const Qe=Math.sqrt(3),Je=2/Qe,Ke={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*Je,i=r/2;t.moveTo(0,r),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(0,-r),t.lineTo(-n,-i),t.lineTo(-n,i),t.closePath()}},tn=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",Ke],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolX],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function en(t){return t&&"function"==typeof t.draw}function nn(t){return!!en(t)||"string"==typeof t&&tn.has(t.toLowerCase())}function rn(t){if(null==t||en(t))return t;const e=tn.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}const on=Symbol("ordinal");function an(t,n,r,{type:i,interval:o,domain:a,range:s,reverse:l,hint:c}){return o=xe(o),void 0===a&&(a=cn(r,o,t)),"categorical"!==i&&i!==on||(i="ordinal"),l&&(a=e.reverse(a)),n.domain(a),void 0!==s&&("function"==typeof s&&(s=s(a)),n.range(s)),{type:i,domain:a,range:s,scale:n,hint:c,interval:o}}function sn(t,n,{type:r,interval:i,domain:o,range:a,scheme:s,unknown:l,...c}){let u;if(i=xe(i),void 0===o&&(o=cn(n,i,t)),re.get(t)===ne)u=function(t){return{fill:un(t,"fill"),stroke:un(t,"stroke")}}(n),a=void 0===a?function(t){return rt(t.fill)?e.symbolsStroke:e.symbolsFill}(u):O(a,rn);else if(re.get(t)===Jt&&(void 0!==a||"ordinal"!==r&&r!==on||(a=function(t,e="greys"){const n=new Set,[r,i]=fe(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(i);else{if(!1!==e)return;n.add(r)}return[...n]}(o,s),void 0!==a&&(s=void 0)),void 0===s&&void 0===a&&(s="ordinal"===r?"turbo":"tableau10"),void 0!==s))if(void 0!==a){const t=de(s),n=a[0],r=a[1]-a[0];a=({length:i})=>e.quantize((e=>t(n+r*e)),i)}else a=ue(s);if(l===e.scaleImplicit)throw new Error("implicit unknown is not supported");return an(t,e.scaleOrdinal().unknown(l),n,{...c,type:r,domain:o,range:a,hint:u})}function ln(t,e,n,r){let{round:i}=n;return void 0!==i&&t.round(i=!!i),(t=an(r,t,e,n)).round=i,t}function cn(t,n,r){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&re.get(r)===Qt)throw new Error("implicit ordinal position domain has more than 10,000 values");return e.sort(i,mt)}function un(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function fn(t,{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,round:a,nice:s,clamp:l,zero:c,align:u,padding:f,...h}={}){const d={};for(const[e,p]of t){const t=h[e],m=vn(e,p,{round:re.get(e)===Qt?a:void 0,nice:s,clamp:l,zero:c,align:u,padding:f,...t});if(m){let{percent:a,transform:s,inset:l,insetTop:c=(void 0!==l?l:"y"===e?n:0),insetRight:u=(void 0!==l?l:"x"===e?r:0),insetBottom:f=(void 0!==l?l:"y"===e?i:0),insetLeft:h=(void 0!==l?l:"x"===e?o:0)}=t||{};if(null==s)s=void 0;else if("function"!=typeof s)throw new Error("invalid scale transform; not a function");m.percent=!!a,m.transform=s,"x"===e||"fx"===e?(m.insetLeft=+h,m.insetRight=+u):"y"!==e&&"fy"!==e||(m.insetTop=+c,m.insetBottom=+f),d[e]=m}}return d}function hn(t){return Object.fromEntries(Object.entries(t).map((([t,{scale:e}])=>[t,e])))}function dn(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:i,marginLeft:o=0,marginRight:a=0}=e,s=o+n,l=i-a-r;t.range=[s,Math.max(s,l)],kn(t)||(t.range=gn(t)),t.scale.range(t.range)}mn(t)}function pn(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:i,marginTop:o=0,marginBottom:a=0}=e,s=o+n,l=i-a-r;t.range=[Math.max(s,l),s],kn(t)?t.range.reverse():t.range=gn(t),t.scale.range(t.range)}mn(t)}function mn(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),i=t.paddingInner?t.paddingInner():1,o=t.paddingOuter?t.paddingOuter():t.padding(),a=e-i,s=Math.abs(r-n)/Math.max(1,a+2*o);return(s-Math.floor(s))*a}(t)<=30&&t.scale.round(!0)}function gn(t){const e=t.scale.domain().length+$n(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,i)=>n+i/(e-1)*(r-n)))}function yn(t,e,n){return vn(t,void 0===n?void 0:[{hint:n}],{...e})}function vn(t,n=[],r={}){const i=function(t,e,{type:n,domain:r,range:i,scheme:o,pivot:a}){if("fx"===t||"fy"===t)return"band";for(const{type:t}of e)if(void 0!==t)if(void 0===n)n=t;else if(n!==t)throw new Error(`scale incompatible with channel: ${n} !== ${t}`);if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const s=re.get(t);if(s===Jt&&void 0===i&&void 0===o&&bn(r,e,nt))return"identity";if(s===ne&&void 0===i&&bn(r,e,nn))return"identity";if(s===Kt)return"sqrt";if(s===ee||s===te)return"linear";if(s===ne)return"ordinal";if((r||i||[]).length>2)return wn(s);if(void 0!==r)return Z(r)?wn(s):Q(r)?"utc":s!==Jt||null==a&&!me(o)?"linear":"diverging";const l=e.map((({value:t})=>t)).filter((t=>void 0!==t));return l.some(Z)?wn(s):l.some(Q)?"utc":s!==Jt||null==a&&!me(o)?"linear":"diverging"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&kn({type:i})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(Q)?kt(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${xn(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${xn(i)}".`):e.some(J)?kt(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${xn(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${xn(i)}".`):e.some(K)&&kt(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${xn(i)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${xn(i)}".`)}switch(r.type=i,i){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=An(n,r,Rn);break;case"identity":switch(re.get(t)){case Qt:r=An(n,r,Rn);break;case ne:r=An(n,r,zn)}break;case"utc":case"time":r=An(n,r,On)}switch(i){case"diverging":return function(t,n,r){return Ie(t,e.scaleDiverging(),Ue,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return Ge(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return Ge(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:i=1,domain:o=Te(n,i<0?wt:xt),...a}){return Ie(t,e.scaleDivergingLog().base(r=+r),Ve,n,{domain:o,pivot:i,...a})}(t,n,r);case"diverging-symlog":return Xe(t,n,r);case"categorical":case"ordinal":case on:return sn(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return Pe(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return Se(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return Ne(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:i=(void 0===r?5:(r=[...r]).length),n:o=i,scheme:a="rdylbu",domain:s=je(n),interpolate:l,reverse:c}){return void 0===r&&(r=void 0!==l?e.quantize(l,o):re.get(t)===Jt?fe(a,o):void 0),Ne(t,0,{domain:e.scaleQuantile(s,void 0===r?{length:o}:r).quantiles(),range:r,reverse:c})}(t,n,r);case"quantize":return function(t,n,{range:r,n:i=(void 0===r?5:(r=[...r]).length),scheme:o="rdylbu",domain:a=De(t,n),interpolate:s,reverse:l}){const[c,u]=e.extent(a);let f;return void 0===r?(f=e.ticks(c,u,i),f[0]<=c&&f.splice(0,1),f[f.length-1]>=u&&f.pop(),i=f.length+1,r=void 0!==s?e.quantize(s,i):re.get(t)===Jt?fe(o,i):void 0):(f=e.quantize(e.interpolateNumber(c,u),i+1).slice(1,-1),c instanceof Date&&(f=f.map((t=>new Date(t))))),at(z(a))<0&&f.reverse(),Ne(t,0,{domain:f,range:r,reverse:l})}(t,n,r);case"pow":return Se(t,n,r);case"log":return function(t,n,{base:r=10,domain:i=_e(n),...o}){return Pe(t,e.scaleLog().base(r),n,{...o,domain:i})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...i}){return Pe(t,e.scaleSymlog().constant(r),n,i)}(t,n,r);case"utc":return function(t,n,r){return Ze(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return Ze(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:i=.5,...o}){return ln(e.scalePoint().align(r).padding(i),n,o,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:i=.1,paddingInner:o=i,paddingOuter:a=("fx"===t||"fy"===t?0:i),...s}){return ln(e.scaleBand().align(r).paddingInner(o).paddingOuter(a),n,s,t)}(t,n,r);case"identity":return re.get(t)===Qt?{type:"identity",scale:e.scaleIdentity()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${i}`)}}function xn(t){return"symbol"==typeof t?t.description:t}function wn(t){switch(t){case Qt:return"point";case Jt:return on;default:return"ordinal"}}function bn(t,e,n){return void 0!==t?tt(t,n)&&et(t,n):e.some((({value:t})=>void 0!==t&&tt(t,n)))&&e.every((({value:t})=>void 0===t||et(t,n)))}function kn({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===on}function $n({type:t}){return"threshold"===t}function Mn({range:t,domain:e=t}){return Math.sign(at(e))*Math.sign(at(t))}function Ln(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,i=e.length;r<i;++r)if(t(e[r])-n)return!1;return!0}function An(t,{domain:e,...n},r){for(const e of t)void 0!==e.value&&(e.value=r(e.value));return{domain:void 0===e?e:r(e),...n}}function zn(t){return O(t,rn)}function On(t){return O(t,Cn)}function Rn(t){return B(t)?t:O(t,Bn,Float64Array)}function Bn(t){return null==t?NaN:+t}function Cn(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?s(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function En({scale:t,type:e,domain:n,range:r,label:i,interpolate:o,interval:a,transform:s,percent:l,pivot:c}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const u=t.unknown?t.unknown():void 0;return{type:e,domain:R(n),...void 0!==r&&{range:R(r)},...void 0!==s&&{transform:s},...l&&{percent:l},...void 0!==i&&{label:i},...void 0!==u&&{unknown:u},...void 0!==a&&{interval:a},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==c&&{pivot:c,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}function Pn(t,n,r){if(void 0===n.ticks){const i=t.interval;if(void 0!==i){const[r,o]=e.extent(t.scale.domain());n.ticks=i.range(i.floor(r),i.offset(i.floor(o)))}else{const[i,o]=e.extent(t.scale.range());n.ticks=(o-i)/r}}void 0===n.tickFormat&&kn(t)&&(n.tickFormat=ht)}function Sn(t,e,n){void 0===t.labelAnchor&&(t.labelAnchor=kn(e)?"center":Mn(e)<0?"left":"right"),void 0===t.label&&(t.label=Dn(n,e,t,"x")),e.label=t.label}function Nn(t,e,n,r){void 0===t.labelAnchor&&(t.labelAnchor=kn(n)?"center":e&&"top"===e.axis?"bottom":"top"),void 0===t.label&&(t.label=Dn(r,n,t,"y")),n.label=t.label}function Tn(t,e,n,r){r&&(e.label=r.label),void 0===e.label&&(e.label=Dn(n,e,null,t))}function Dn(t=[],e,n,r){let i;for(const{label:e}of t)if(void 0!==e)if(void 0===i)i=e;else if(i!==e)return;if(void 0!==i){if(function({type:t}){return"time"===t||"utc"===t}(e)&&/^(date|time|year)$/i.test(i))return;if(!kn(e)&&(e.percent&&(i=`${i} (%)`),"x"===r||"y"===r)){const t=Mn(e);t&&(i="x"===r||n&&"center"===n.labelAnchor?"x"===r==t<0?`← ${i}`:`${i} →`:`${t<0?"↑ ":"↓ "}${i}`)}}return i}function qn(t){return kn(t)&&void 0===t.interval?void 0:"tabular-nums"}function Wn({filter:t,sort:e,reverse:n,transform:r,initializer:i,...o}={},a){if(void 0===r&&(null!=t&&(r=In(t)),null==e||S(e)||(r=_n(r,Un(e))),n&&(r=_n(r,Gn))),null!=a&&null!=i)throw new Error("transforms cannot be applied after initializers");return{...o,...(null===e||S(e))&&{sort:e},transform:_n(r,a)}}function Yn({filter:t,sort:e,reverse:n,initializer:r,...i}={},o){return void 0===r&&(null!=t&&(r=In(t)),null==e||S(e)||(r=jn(r,Un(e))),n&&(r=jn(r,Gn))),{...i,initializer:jn(r,o)}}function _n(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r){return({data:n,facets:r}=t.call(this,n,r)),e.call(this,z(n),r)}}function jn(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,i,o,a){let s,l,c,u,f,h;return({data:l=n,facets:c=r,channels:s}=t.call(this,n,r,i,o,a)),({data:f=l,facets:h=c,channels:u}=e.call(this,l,c,{...i,...s},o,a)),{data:f,facets:h,channels:{...s,...u}}}}function Fn(t,e){return(null!=t.initializer?Yn:Wn)(t,e)}function In(t){return(e,n)=>{const r=u(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function Gn(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function Xn(t,e){return{...(P(t)&&void 0!==t.channel?Yn:Fn)(e,Un(t)),sort:null}}function Un(t){return("function"==typeof t&&1!==t.length?Vn:Hn)(t)}function Vn(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function Hn(t){let e,n;if(({channel:e,value:t,order:n=mt}={...U(t)}),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=mt;break;case"descending":n=gt;break;default:throw new Error(`invalid order: ${n}`)}return(r,i,o)=>{let a;if(void 0===e)a=u(r,t);else{if(void 0===o)throw new Error("channel sort requires an initializer");if(a=o[e],!a)return{};a=a.value}const s=(t,e)=>n(a[t],a[e]);return{data:r,facets:i.map((t=>t.slice().sort(s)))}}}function Zn(t,e){return Kn(null,null,t,e)}function Qn(t={y:"count"},e={}){const{x:n=d}=e;if(null==n)throw new Error("missing channel: x");return Kn(n,null,t,e)}function Jn(t={x:"count"},e={}){const{y:n=d}=e;if(null==n)throw new Error("missing channel: y");return Kn(null,n,t,e)}function Kn(t,e,{data:n=cr,filter:r,sort:i,reverse:o,...a}={},s={}){a=er(a,s),n=or(n,d),i=null==i?void 0:nr("sort",i,s),r=null==r?void 0:rr("filter",r,s);const[l,c]=I(t),[f,h]=I(e),{z:p,fill:m,stroke:g,x1:y,x2:v,y1:x,y2:w,...b}=s,[k,M]=I(p),[L]=$(m),[A]=$(g),[z,O]=I(L),[R,B]=I(A);return{..."z"in s&&{z:k||p},..."fill"in s&&{fill:z||m},..."stroke"in s&&{stroke:R||g},...Wn(b,((s,l)=>{const f=u(s,t),d=u(s,e),m=u(s,p),g=u(s,L),y=u(s,A),v=ar(a,{z:m,fill:g,stroke:y}),x=[],w=[],b=f&&c([]),k=d&&h([]),$=m&&M([]),z=g&&O([]),R=y&&B([]);let C=0;for(const t of a)t.initialize(s);i&&i.initialize(s),r&&r.initialize(s);for(const t of l){const e=[];for(const e of a)e.scope("facet",t);i&&i.scope("facet",t),r&&r.scope("facet",t);for(const[o,l]of ir(t,v))for(const[t,c]of ir(l,d))for(const[l,u]of ir(c,f))if(!r||r.reduce(u)){e.push(C++),w.push(n.reduce(u,s)),f&&b.push(l),d&&k.push(t),m&&$.push(v===m?o:m[u[0]]),g&&z.push(v===g?o:g[u[0]]),y&&R.push(v===y?o:y[u[0]]);for(const t of a)t.reduce(u);i&&i.reduce(u)}x.push(e)}return sr(x,i,o),{data:w,facets:x}})),...!tr(a,"x")&&(l?{x:l}:{x1:y,x2:v}),...!tr(a,"y")&&(f?{y:f}:{y1:x,y2:w}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function tr(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function er(t,e){const n=Object.entries(t);return null!=e.title&&void 0===t.title&&n.push(["title",fr]),null!=e.href&&void 0===t.href&&n.push(["href",ur]),n.map((([t,n])=>null==n?{name:t,initialize(){},scope(){},reduce(){}}:nr(t,n,e)))}function nr(t,e,n){const r=rr(t,e,n),[i,o]=F(r.label);let a;return{name:t,output:i,initialize(t){r.initialize(t),a=o([])},scope(t,e){r.scope(t,e)},reduce(t,e){a.push(r.reduce(t,e))}}}function rr(t,e,n){const r=j(t,n),i=or(e,r);let o,a;return{label:G(i===dr?null:r,i.label),initialize(t){o=void 0===r?t:u(t,r),"data"===i.scope&&(a=i.reduce(q(t),o))},scope(t,e){i.scope===t&&(a=i.reduce(e,o))},reduce:(t,e)=>null==i.scope?i.reduce(t,o,e):i.reduce(t,o,a,e)}}function ir(t,n){return n?e.sort(e.group(t,(t=>n[t])),x):[[,t]]}function or(t,n){if(t&&"function"==typeof t.reduce)return t;if("function"==typeof t)return r=t,{reduce:(t,e,n)=>r(Y(e,t),n)};var r;if(/^p\d{2}$/i.test(t))return lr(k(t));switch(`${t}`.toLowerCase()){case"first":return ur;case"last":return hr;case"count":return dr;case"distinct":return pr;case"sum":return null==n?dr:mr;case"proportion":return gr(n,"data");case"proportion-facet":return gr(n,"facet");case"deviation":return lr(e.deviation);case"min":return lr(e.min);case"min-index":return lr(e.minIndex);case"max":return lr(e.max);case"max-index":return lr(e.maxIndex);case"mean":return lr(e.mean);case"median":return lr(e.median);case"variance":return lr(e.variance);case"mode":return lr(e.mode);case"x":return vr;case"x1":return wr;case"x2":return br;case"y":return xr;case"y1":return kr;case"y2":return $r}throw new Error(`invalid reduce: ${t}`)}function ar(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function sr(t,e,n){if(e){const n=e.output.transform(),r=(t,e)=>mt(n[t],n[e]);t.forEach((t=>t.sort(r)))}n&&t.forEach((t=>t.reverse()))}function lr(t){return{reduce:(e,n)=>t(e,(t=>n[t]))}}const cr={reduce:(t,e)=>Y(e,t)},ur={reduce:(t,e)=>e[t[0]]},fr={reduce(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),w),i=r.slice(-5).reverse();if(i.length<r.length){const t=r.slice(0,-4);i[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,w)]}return i.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},hr={reduce:(t,e)=>e[t[t.length-1]]},dr={label:"Frequency",reduce:t=>t.length},pr={label:"Distinct",reduce:(t,n)=>{const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},mr=lr(e.sum);function gr(t,n){return null==t?{scope:n,label:"Frequency",reduce:(t,e,n=1)=>t.length/n}:{scope:n,reduce:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}function yr(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const vr={reduce:(t,e,{x1:n,x2:r})=>yr(n,r)},xr={reduce:(t,e,{y1:n,y2:r})=>yr(n,r)},wr={reduce:(t,e,{x1:n})=>n},br={reduce:(t,e,{x2:n})=>n},kr={reduce:(t,e,{y1:n})=>n},$r={reduce:(t,e,{y2:n})=>n};function Mr(t,{scale:e,type:n,value:r,filter:i,hint:o}){return{scale:e,type:n,value:u(t,r),label:G(r),filter:i,hint:o}}function Lr(t,e){const n={};for(const r in t){const{scale:i,value:o}=t[r],a=e[i];n[r]=void 0===a?o:O(o,a)}return n}function Ar(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function zr(t,e,n){const r=Or(t,e);return O(Or(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function Or(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function Rr([t,n],[r,i]){return e.ascending(n,i)||e.ascending(t,r)}function Br([t,n],[r,i]){return e.descending(n,i)||e.ascending(t,r)}function Cr({y:t,fy:e,fx:n}){const r=e?e.scale.domain().length:1,i=t?kn(t)?t.scale.domain().length:Math.max(7,17/r):1;return!(!t&&!e)*Math.max(1,Math.min(60,i*r))*20+30*!!n+60}function Er(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Pr(t,e={},i,o){let{columns:a,tickFormat:s,fontVariant:l=qn(t),swatchSize:c=15,swatchWidth:u=c,swatchHeight:f=c,marginLeft:h=0,className:d,style:p,width:m}=e;const g=n(e);d=Yt(d),s=Vt(s,t.domain);const y=r("div",g).attr("class",d).attr("style",`\n        --swatchWidth: ${+u}px;\n        --swatchHeight: ${+f}px;\n      `);let v;return null!=a?(v=`\n      .${d}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${d}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${d}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,y.style("columns",a).selectAll().data(t.domain).enter().append("div").attr("class",`${d}-swatch`).call(i,t).call((t=>t.append("div").attr("class",`${d}-label`).attr("title",s).text(s)))):(v=`\n      .${d} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${d}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,y.selectAll().data(t.domain).enter().append("span").attr("class",`${d}-swatch`).call(i,t).append((function(){return this.ownerDocument.createTextNode(s.apply(this,arguments))}))),y.call((t=>t.insert("style","*").text(`\n        .${d} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===h?"":`\n          margin-left: ${+h}px;`}${void 0===m?"":`\n          width: ${m}px;`}\n        }\n        ${o(d)}\n        ${v}\n      `))).style("font-variant",Dt(l,"normal")).call(_t,p).node()}const Sr=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:i=(void 0!==t.hint?.stroke?t.hint.stroke:rt(n)?"currentColor":"none"),strokeOpacity:o=1,strokeWidth:a=1.5,r:s=4.5,...l}={},c){const[u,f]=$(n),[h,d]=$(i),p=Er(c,u),m=Er(c,h),g=s*s*Math.PI;return r=M(r)[1],o=M(o)[1],a=M(a)[1],Pr(t,l,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===u?t=>p.scale(t):null).attr("stroke","color"===h?t=>m.scale(t):null).append("path").attr("d",(n=>{const r=e.path();return t.scale(n).draw(r,g),r}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${f};\n        fill-opacity: ${r};\n        stroke: ${d};\n        stroke-width: ${a}px;\n        stroke-opacity: ${o};\n      }`))}],["color",Tr],["opacity",function({type:t,interpolate:n,...r},{legend:i=!0,color:o=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===i&&(i="ramp");if("ramp"!==`${i}`.toLowerCase())throw new Error(`${i} opacity legends are not supported`);return Tr({type:t,...r,interpolate:Dr(o)},{legend:i,...a})}]]);function Nr(t,{label:e,ticks:n,tickFormat:r}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const i=r[e];n===t?n={...n,[e]:i}:n[e]=i}return n}(i,t,{label:e,ticks:n,tickFormat:r})}function Tr(t,{legend:i=!0,...o}){if(!0===i&&(i="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${i}`.toLowerCase()){case"swatches":return function(t,e){if(!kn(t)&&!$n(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return Pr(t,e,((t,e)=>t.append("svg").attr("fill",e.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,o);case"ramp":return function(t,i){let{label:o=t.label,tickSize:a=6,width:s=240,height:l=44+a,marginTop:c=18,marginRight:u=0,marginBottom:f=16+a,marginLeft:h=0,style:d,ticks:p=(s-h-u)/64,tickFormat:m,fontVariant:g=qn(t),round:y=!0,className:v}=i;const x=n(i);v=Yt(v),null===m&&(m=()=>null);const w=r("svg",x).attr("class",v).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",s).attr("height",l).attr("viewBox",`0 0 ${s} ${l}`).call((t=>t.append("style").text(`\n        .${v} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${v} text {\n          white-space: pre;\n        }\n      `))).call(_t,d);let b,k=t=>t.selectAll(".tick line").attr("y1",c+f-l);const $=y?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:M,domain:L,range:A,interpolate:z,scale:R,pivot:B}=t;if(z){const t=void 0===A?z:e.piecewise(1===z.length?Fe(z):z,A);b=$(R.copy(),e.quantize(e.interpolateNumber(h,s-u),Math.min(L.length+(void 0!==B),void 0===A?1/0:A.length)));const n=256,r=x.document.createElement("canvas");r.width=n,r.height=1;const i=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)i.fillStyle=t(e/r),i.fillRect(e,0,1,1);w.append("image").attr("x",h).attr("y",c).attr("width",s-h-u).attr("height",l-c-f).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===M){const t=L,n=void 0===m?t=>t:"string"==typeof m?e.format(m):m;b=$(e.scaleLinear().domain([-1,A.length-1]),[h,s-u]),w.append("g").selectAll().data(A).enter().append("rect").attr("x",((t,e)=>b(e-1))).attr("y",c).attr("width",((t,e)=>b(e)-b(e-1))).attr("height",l-c-f).attr("fill",(t=>t)),p=O(t,((t,e)=>e)),m=e=>n(t[e],e)}else b=$(e.scaleBand().domain(L),[h,s-u]),w.append("g").selectAll().data(L).enter().append("rect").attr("x",b).attr("y",c).attr("width",Math.max(0,b.bandwidth()-1)).attr("height",l-c-f).attr("fill",R),k=()=>{};return w.append("g").attr("transform",`translate(0,${l-f})`).call(e.axisBottom(b).ticks(Array.isArray(p)?null:p,"string"==typeof m?m:void 0).tickFormat("function"==typeof m?m:void 0).tickSize(a).tickValues(Array.isArray(p)?p:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Dt(g,"normal")).call(k).call((t=>t.select(".domain").remove())),void 0!==o&&w.append("text").attr("x",h).attr("y",c-6).attr("fill","currentColor").attr("font-weight","bold").text(o),w.node()}(t,o);default:throw new Error(`unknown legend type: ${i}`)}}function Dr(t){const{r:n,g:r,b:i}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${i},${t})`}function qr(t={}){const{facet:i,style:o,caption:a,ariaLabel:s,ariaDescription:l}=t,c=Yt(t.className),u=void 0===t.marks?[]:t.marks.flat(1/0).map(_r),f=new Map,h=new Map;for(const e of re.keys())E(t[e])&&"fx"!==e&&"fy"!==e&&h.set(e,[]);let d,p,m,g,y;if(void 0!==i){const{x:t,y:n}=i;if(null!=t||null!=n){const r=z(i.data);if(null==r)throw new Error("missing facet data");if(m={},null!=t){const e=Mr(r,{value:t,scale:"fx"});m.fx=e,h.set("fx",[e])}if(null!=n){const t=Mr(r,{value:n,scale:"fy"});m.fy=t,h.set("fy",[t])}p=q(r),d=function(t,{fx:n,fy:r}){return n&&r?function(t,{value:n},{value:r}){return e.groups(t,(t=>n[t]),(t=>r[t])).flatMap((([t,e])=>e.map((([e,n])=>[[t,e],n]))))}(t,n,r):Ur(t,n||r)}(p,m),g=d.map(w)}}for(const n of u){if(f.has(n))throw new Error("duplicate mark; each mark must be unique");const r=void 0===g?void 0:"auto"===n.facet?n.data===i.data?g:void 0:"include"===n.facet?g:"exclude"===n.facet?y||(y=g.map((t=>Uint32Array.from(e.difference(p,t))))):void 0,{data:o,facets:a,channels:s}=n.initialize(r,m);Fr(s,t),f.set(n,{data:o,facets:a,channels:s})}const v=fn(Gr(h,f),t),x=hn(v),b=function({x:t,y:e,fx:n,fy:r},{x:i={},y:o={},fx:a={},fy:s={},axis:l=!0,grid:c,line:u,label:f,facet:{axis:h=l,grid:d,label:p=f}={}}={}){let{axis:m=l}=i,{axis:g=l}=o,{axis:y=h}=a,{axis:v=h}=s;return t?!0===m&&(m="bottom"):m=null,e?!0===g&&(g="left"):g=null,n?!0===y&&(y="bottom"===m?"top":"bottom"):y=null,r?!0===v&&(v="left"===g?"right":"left"):v=null,{...m&&{x:new Ft({grid:c,line:u,label:f,fontVariant:qn(t),...i,axis:m})},...g&&{y:new It({grid:c,line:u,label:f,fontVariant:qn(e),...o,axis:g})},...y&&{fx:new Ft({name:"fx",grid:d,label:p,fontVariant:qn(n),...a,axis:y})},...v&&{fy:new It({name:"fy",grid:d,label:p,fontVariant:qn(r),...s,axis:v})}}}(v,t),k=function(t,{x:{axis:e}={},y:{axis:n}={},fx:{axis:r}={},fy:{axis:i}={}},{width:o=640,height:a=Cr(t),facet:{margin:s,marginTop:l=(void 0!==s?s:"top"===r?30:0),marginRight:c=(void 0!==s?s:"right"===i?40:0),marginBottom:u=(void 0!==s?s:"bottom"===r?30:0),marginLeft:f=(void 0!==s?s:"left"===i?40:0)}={},margin:h,marginTop:d=(void 0!==h?h:Math.max(("top"===e?30:0)+l,n||i?20:.5-$t)),marginRight:p=(void 0!==h?h:Math.max(("right"===n?40:0)+c,e||r?20:.5+$t)),marginBottom:m=(void 0!==h?h:Math.max(("bottom"===e?30:0)+u,n||i?20:.5+$t)),marginLeft:g=(void 0!==h?h:Math.max(("left"===n?40:0)+f,e||r?20:.5-$t))}={}){return{width:o,height:a,marginTop:d,marginRight:p,marginBottom:m,marginLeft:g,facetMarginTop:l,facetMarginRight:c,facetMarginBottom:u,facetMarginLeft:f}}(v,b,t),$=n(t);!function({x:t,y:e,fx:n,fy:r},i){n&&dn(n,i),r&&pn(r,i),t&&dn(t,n?{width:n.scale.bandwidth()}:i),e&&pn(e,r?{height:r.scale.bandwidth()}:i)}(v,k),function({x:t,y:e,fx:n,fy:r},{x:i,y:o,fx:a,fy:s}){a&&Pn(n,a,80),s&&Pn(r,s,35),i&&Pn(t,i,80),o&&Pn(e,o,35)}(v,b);const{fx:M,fy:L}=x,A=L&&{marginTop:0,marginBottom:0,height:L.bandwidth()},O=M&&{marginRight:0,marginLeft:0,width:M.bandwidth()},R={...k,...O,...A},B=new Set;for(const[e,n]of f)if(null!=e.initializer){const{facets:r,channels:i}=e.initializer(n.data,n.facets,n.channels,x,R);if(void 0!==r&&(n.facets=r),void 0!==i){Ir(i),Fr(i,t),Object.assign(n.channels,i);for(const{scale:t}of Object.values(i))null!=t&&B.add(t)}}if(B.size){for(const t of B)if(re.get(t)===Qt)throw new Error(`initializers cannot declare position scales: ${t}`);const e=fn(Gr(new Map,f,(t=>B.has(t))),t),n=hn(e);Object.assign(v,e),Object.assign(x,n)}!function(t,e,{x:n,y:r,fx:i,fy:o},a,s){if(i&&(Sn(i,e.fx,t.get("fx")),void 0===i.labelOffset)){const{facetMarginTop:t,facetMarginBottom:e}=a;i.labelOffset="top"===i.axis?t:e}if(o&&(Nn(o,i,e.fy,t.get("fy")),void 0===o.labelOffset)){const{facetMarginLeft:t,facetMarginRight:e}=a;o.labelOffset="left"===o.axis?t:e}if(n&&(Sn(n,e.x,t.get("x")),void 0===n.labelOffset)){const{marginTop:t,marginBottom:e,facetMarginTop:r,facetMarginBottom:i}=a;n.labelOffset="top"===n.axis?t-r:e-i}if(r&&(Nn(r,n,e.y,t.get("y")),void 0===r.labelOffset)){const{marginRight:t,marginLeft:e,facetMarginLeft:n,facetMarginRight:i}=a;r.labelOffset="left"===r.axis?e-n:t-i}for(const[n,r]of re)r!==Qt&&e[n]&&Tn(n,e[n],t.get(n),s[n])}(h,v,b,k,t);for(const t of f.values())t.values=Lr(t.channels,x);const{width:C,height:P}=k,S=r("svg",$).attr("class",c).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",C).attr("height",P).attr("viewBox",`0 0 ${C} ${P}`).attr("aria-label",s).attr("aria-description",l).call((t=>t.append("style").text(`\n        .${c} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n        }\n        .${c} text,\n        .${c} tspan {\n          white-space: pre;\n        }\n      `))).call(_t,o).node(),N=b[void 0!==d&&L?"fy":"y"],T=b[void 0!==d&&M?"fx":"x"];if(N&&S.appendChild(N.render(null,x,k,$)),T&&S.appendChild(T.render(null,x,k,$)),void 0!==d){const t=L&&L.domain(),n=M&&M.domain(),r=function({fx:t,fy:e}){return new(t&&e?Hr:Vr)}(m);d.forEach((([t],e)=>r.set(t,e)));const i=e.select(S);if(L&&b.y){const e=b.y,o=Xr(e),a="bottom"===e.labelAnchor?t.length-1:"center"===e.labelAnchor?t.length>>1:0;i.selectAll().data(t).enter().append(((t,i)=>(i===a?e:o).render(M&&W(n,(e=>r.has([e,t]))),x,{...k,...A,offsetTop:L(t)},$)))}if(M&&b.x){const e=b.x,o=Xr(e),a="right"===e.labelAnchor?n.length-1:"center"===e.labelAnchor?n.length>>1:0,{marginLeft:s,marginRight:l}=k;i.selectAll().data(n).enter().append(((n,i)=>(i===a?e:o).render(L&&W(t,(t=>r.has([n,t]))),x,{...k,...O,labelMarginLeft:s,labelMarginRight:l,offsetLeft:M(n)},$)))}i.selectAll().data(function({fx:t,fy:n}){return t&&n?e.cross(t.domain(),n.domain()):t?t.domain():n.domain()}(x).filter(r.has,r)).enter().append("g").attr("aria-label","facet").attr("transform",function(t,e){return t&&e?([n,r])=>`translate(${t(n)},${e(r)})`:t?e=>`translate(${t(e)},0)`:t=>`translate(0,${e(t)})`}(M,L)).each((function(t){const e=r.get(t);for(const[t,{channels:n,values:r,facets:i}]of f){const o=i?t.filter(i[e]??i[0],n,r):null,a=t.render(o,x,r,R,$);null!=a&&this.appendChild(a)}}))}else for(const[t,{channels:e,values:n,facets:r}]of f){const i=r?t.filter(r[0],e,n):null,o=t.render(i,x,n,k,$);null!=o&&S.appendChild(o)}let D=S;const Y=function(t,e,n){const r=[];for(const[i,o]of Sr){const a=n[i];if(a?.legend&&i in t){const n=o(t[i],Nr(e,t[i],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(v,$,t);if(null!=a||Y.length>0){const{document:t}=$;D=t.createElement("figure"),D.style.maxWidth="initial";for(const t of Y)D.appendChild(t);if(D.appendChild(S),null!=a){const e=t.createElement("figcaption");e.appendChild(a instanceof Node?a:t.createTextNode(a)),D.appendChild(e)}}D.scale=function(t){return e=>{if(!re.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return e in t?En(t[e]):void 0}}(v),D.legend=function(t,e,n={}){return(r,i)=>{if(!Sr.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Sr.get(r)(t[r],Nr(e,n[r],i),(e=>t[e]))}}(v,$,t);const _=function(){const t=bt;return bt=0,t}();return _>0&&e.select(S).append("text").attr("x",C).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${_.toLocaleString("en-US")} warning${1===_?"":"s"}. Please check the console.`),D}class Wr{constructor(t,e=[],n={},r){const{facet:i="auto",sort:o,dx:a,dy:s,clip:l,channels:c}=n,u=new Set;this.data=t,this.sort=S(o)?o:null,this.initializer=Yn(n).initializer,this.transform=this.initializer?n.transform:Wn(n).transform,this.facet=null==i||!1===i?null:A(!0===i?"include":i,"facet",["auto","include","exclude"]),void 0!==c&&(e=[...e,...c.filter((t=>!e.some((e=>e.name===t.name))))]),void 0!==r&&(e=[...e,...Lt(this,n,r)]),this.channels=e.filter((t=>{const{name:e,value:n,optional:r}=t;if(null==n){if(r)return!1;throw new Error(`missing channel value: ${e}`)}if(null==e)throw new Error("missing channel name");const i=`${e}`;if("__proto__"===i)throw new Error(`illegal channel name: ${i}`);if(u.has(i))throw new Error(`duplicate channel: ${i}`);return u.add(i),!0})),this.dx=+a||0,this.dy=+s||0,this.clip=function(t){if(!0===t)return"frame";if(null==t||!1===t)return!1;throw new Error(`invalid clip method: ${t}`)}(l)}initialize(t,n){let r=z(this.data);void 0===t&&null!=r&&(t=[q(r)]),null!=this.transform&&(({facets:t,data:r}=this.transform(r,t)),r=z(r));const i=function(t,e){const n={};for(const r of t)n[r.name]=Mr(e,r);return n}(this.channels,r);return null!=this.sort&&function(t,n,r,i){const{reverse:o,reduce:a=!0,limit:s}=i;for(const l in i){if(!re.has(l))continue;let{value:c,reverse:u=o,reduce:f=a,limit:h=s}=U(i[l]);if(void 0===u&&(u="width"===c||"height"===c),null==f||!1===f)continue;const d=Ar(t,l)||n&&Ar(n,l);if(!d)throw new Error(`missing channel for scale: ${l}`);const p=d.value,[m=0,g=1/0]=V(h)?h:h<0?[h]:[0,h];if(null==c)d.domain=()=>{let t=p;return u&&(t=t.slice().reverse()),0===m&&g===1/0||(t=t.slice(m,g)),t};else{const n="data"===c?r:"height"===c?zr(t,"y1","y2"):"width"===c?zr(t,"x1","x2"):Or(t,c,"y"===c?"y2":"x"===c?"x2":void 0),i=or(!0===f?"max":f,n);d.domain=()=>{let t=e.rollup(q(p),(t=>i.reduce(t,n)),(t=>p[t]));return t=e.sort(t,u?Br:Rr),0===m&&g===1/0||(t=t.slice(m,g)),t.map(x)}}}}(i,n,r,this.sort),{data:r,facets:t,channels:i}}filter(t,e,n){for(const r in e){const{filter:i=pt}=e[r];if(null!==i){const e=n[r];t=t.filter((t=>i(e[t])))}}return t}plot({marks:t=[],...e}={}){return qr({...e,marks:[...t,this]})}}function Yr(...t){return t.plot=Wr.prototype.plot,t}function _r(t){return"function"==typeof t?.render?t:new jr(t)}class jr extends Wr{constructor(t){if(super(),null!=t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");this.render=t}}render(){}}function Fr(t,e){for(const n in t){const r=t[n],{scale:i}=r;if(null!=i){const{percent:t,interval:n,transform:o=(t?t=>100*t:xe(n)?.floor)}=e[i]||{};null!=o&&(r.value=O(r.value,o))}}return t}function Ir(t){for(const e in t){const n=t[e];let{scale:r}=n;if(!0===r){switch(e){case"fill":case"stroke":r="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":r="opacity";break;default:r=re.has(e)?e:null}n.scale=r}}}function Gr(t,e,n=m){for(const{channels:r}of e.values())for(const e in r){const i=r[e],{scale:o}=i;if(null!=o&&n(o)){const e=t.get(o);void 0!==e?e.push(i):t.set(o,[i])}}return t}function Xr(t){return void 0===t||void 0===t.label?t:Object.assign(Object.create(t),{label:void 0})}function Ur(t,{value:n}){return e.groups(t,(t=>n[t]))}class Vr{constructor(){this._=new e.InternMap}has(t){return this._.has(t)}get(t){return this._.get(t)}set(t,e){return this._.set(t,e),this}}class Hr extends Vr{has([t,e]){const n=super.get(t);return!!n&&n.has(e)}get([t,e]){const n=super.get(t);return n&&n.get(e)}set([t,n],r){const i=super.get(t);return i?i.set(n,r):super.set(t,new e.InternMap([[n,r]])),this}}const Zr=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function Qr(t=e.curveLinear,n){if("function"==typeof t)return t;const r=Zr.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function Jr(t={y:"count"},e={}){[t,e]=ii(t,e);const{x:n,y:r}=e;return ri(oi(n,e,d),null,null,r,t,ge(e))}function Kr(t={x:"count"},e={}){[t,e]=ii(t,e);const{x:n,y:r}=e;return ri(null,oi(r,e,d),n,null,t,ye(e))}function ti(t,e,n={}){return null==n?.interval?n:t({[e]:void 0===n?.reduce?ur:n.reduce,filter:null},n)}function ei(t){return ti(Jr,"y",t)}function ni(t){return ti(Kr,"x",t)}function ri(t,e,n,r,{data:i=cr,filter:o=dr,sort:a,reverse:s,...l}={},c={}){t=ai(t),e=ai(e),l=er(l,c),i=or(i,d),a=null==a?void 0:nr("sort",a,c),o=null==o?void 0:rr("filter",o,c),null!=n&&tr(l,"x","x1","x2")&&(n=null),null!=r&&tr(l,"y","y1","y2")&&(r=null);const[f,h]=I(t),[p,m]=I(t),[g,y]=I(e),[v,x]=I(e),[w,b]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[k,M]=I(w),{x:L,y:A,z:z,fill:O,stroke:R,x1:B,x2:C,y1:E,y2:P,domain:S,cumulative:N,thresholds:T,interval:D,...q}=c,[W,Y]=I(z),[_]=$(O),[j]=$(R),[F,G]=I(_),[U,V]=I(j);return{..."z"in c&&{z:W||z},..."fill"in c&&{fill:F||O},..."stroke"in c&&{stroke:U||R},...Wn(q,((n,r)=>{const c=u(n,w),f=u(n,z),d=u(n,_),p=u(n,j),g=ar(l,{z:f,fill:d,stroke:p}),v=[],b=[],k=c&&M([]),$=f&&Y([]),L=d&&G([]),A=p&&V([]),O=t?t(n):[[,,t=>t]],R=e?e(n):[[,,t=>t]],B=t&&h([]),C=t&&m([]),E=e&&y([]),P=e&&x([]);let S=0;for(const t of l)t.initialize(n);a&&a.initialize(n),o&&o.initialize(n);for(const t of r){const e=[];for(const e of l)e.scope("facet",t);a&&a.scope("facet",t),o&&o.scope("facet",t);for(const[r,s]of ir(t,g))for(const[t,u]of ir(s,c))for(const[s,h,m]of O){const y=m(u);for(const[u,m,v]of R){const x={x1:s,x2:h,y1:u,y2:m},w=v(y);if(!o||o.reduce(w,x)){e.push(S++),b.push(i.reduce(w,n,x)),c&&k.push(t),f&&$.push(g===f?r:f[w[0]]),d&&L.push(g===d?r:d[w[0]]),p&&A.push(g===p?r:p[w[0]]),B&&(B.push(s),C.push(h)),E&&(E.push(u),P.push(m));for(const t of l)t.reduce(w,x);a&&a.reduce(w)}}}v.push(e)}return sr(v,a,s),{data:b,facets:v}})),...!tr(l,"x")&&(f?{x1:f,x2:p,x:X(f,p)}:{x:L,x1:B,x2:C}),...!tr(l,"y")&&(g?{y1:g,y2:v,y:X(g,v)}:{y:A,y1:E,y2:P}),...k&&{[b]:k},...Object.fromEntries(l.map((({name:t,output:e})=>[t,e])))}}function ii({cumulative:t,domain:e,thresholds:n,interval:r,...i},o){return[i,{cumulative:t,domain:e,thresholds:n,interval:r,...o}]}function oi(t,{cumulative:n,domain:r,thresholds:i,interval:o},a){return void 0===(t={...U(t)}).domain&&(t.domain=r),void 0===t.cumulative&&(t.cumulative=n),void 0===t.thresholds&&(t.thresholds=i),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=a),t.thresholds=function(t,n){if(void 0===t)return void 0===n?si:function(t){if(!li(t=xe(t)))throw new Error(`invalid interval: ${t}`);return t}(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return si}throw new Error(`invalid thresholds: ${t}`)}return t}(t.thresholds,t.interval),t}function ai(t){if(null==t)return;const{value:n,cumulative:r,domain:i=e.extent,thresholds:o}=t,a=t=>{let a=u(t,n,Array);const s=e.bin().value((t=>a[t]));if(Q(a)||(function(t){return li(t)&&"function"==typeof t&&t()instanceof Date}(l=o)||V(l)&&Q(l))){a=a.map(Cn);let[t,n]="function"==typeof i?i(a):i,r="function"!=typeof o||li(o)?o:o(a,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),li(r)&&(i===e.extent&&(t=r.floor(t),n=r.ceil(new Date(+n+1))),r=r.range(t,n)),s.thresholds(r).domain([t,n])}else{a=a.map(Bn);let t=i,n=o;if(li(n)){let[r,i]="function"==typeof t?t(a):t;t===e.extent&&(r=n.floor(r),i=n.offset(n.floor(i)),t=[r,i]),n=n.range(r,i)}s.thresholds(n).domain(t)}var l;let c=s(q(t)).map(ci);return r&&(c=(r<0?c.reverse():c).map(ui)),c.map(fi)};return a.label=G(n),a}function si(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function li(t){return!!t&&"function"==typeof t.range}function ci(t){return[t,new Set(t)]}function ui([t],e,n){return[t,{get size(){for(let t=0;t<=e;++t)if(n[t][1].size)return 1;return 0},has(t){for(let r=0;r<=e;++r)if(n[r][1].has(t))return!0;return!1}}]}function fi([{x0:t,x1:e},n]){return[t,e,n.size?t=>t.filter(n.has,n):hi]}function hi(){return new Uint32Array(0)}function di(t={}){const{x:e,x1:n,x2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,x:d}:t}function pi(t={}){const{y:e,y1:n,y2:r}=t;return void 0===n&&void 0===r&&void 0===e?{...t,y:d}:t}function mi(t={},e={}){1===arguments.length&&([t,e]=xi(t));const{y1:n,y:r=n,x:i,...o}=e,[a,s,l,c]=wi(r,i,"x",t,o);return{...a,y1:n,y:s,x1:l,x2:c,x:X(l,c)}}function gi(t={},e={}){1===arguments.length&&([t,e]=xi(t));const{x1:n,x:r=n,y:i,...o}=e,[a,s,l,c]=wi(r,i,"y",t,o);return{...a,x1:n,x:s,y1:l,y2:c,y:X(l,c)}}function yi({x:t,x1:e,x2:n,...r}={}){return void 0===e&&void 0===n?mi({x:t,...r}):([e,n]=N(t,e,n),{...r,x1:e,x2:n})}function vi({y:t,y1:e,y2:n,...r}={}){return void 0===e&&void 0===n?gi({y:t,...r}):([e,n]=N(t,e,n),{...r,y1:e,y2:n})}function xi(t){const{offset:e,order:n,reverse:r,...i}=t;return[{offset:e,order:n,reverse:r},i]}function wi(t,n=p,r,{offset:i,order:o,reverse:a},s){const l=D(s),[c,h]=I(t),[d,m]=F(n),[g,y]=F(n);return i=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return ki;case"center":case"silhouette":return $i;case"wiggle":return Mi}throw new Error(`unknown offset: ${t}`)}(i),o=function(t,e,n){if(void 0===t&&e===Mi)return Ci;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case n:return zi;case"z":return Oi;case"sum":return Ri;case"appearance":return Bi;case"inside-out":return Ci}return Ei(f(t))}if("function"==typeof t)return Ei(t);if(Array.isArray(t))return r=t,(t,e,n,i)=>Pi(i,r);var r;throw new Error(`invalid order: ${t}`)}(o,i,r),[Wn(s,((r,s)=>{const c=null==t?void 0:h(u(r,t)),f=u(r,n,Float64Array),d=u(r,l),p=o&&o(r,c,f,d),g=r.length,v=m(new Float64Array(g)),x=y(new Float64Array(g)),w=[];for(const t of s){const n=c?Array.from(e.group(t,(t=>c[t])).values()):[t];p&&Si(n,p);for(const t of n){let e=0,n=0;a&&t.reverse();for(const r of t){const t=f[r];t<0?e=x[r]=(v[r]=e)+t:t>0?n=x[r]=(v[r]=n)+t:x[r]=v[r]=n}}w.push(n)}return i&&i(w,v,x,d),{data:r,facets:s}})),c,d,g]}function bi(t,e){let n=0,r=0;for(const i of t){const t=e[i];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function ki(t,e,n){for(const r of t)for(const t of r){const[r,i]=bi(t,n);for(const o of t){const t=1/(i-r||1);e[o]=t*(e[o]-r),n[o]=t*(n[o]-r)}}}function $i(t,e,n){for(const r of t){for(const t of r){const[r,i]=bi(t,n);for(const o of t){const t=(i+r)/2;e[o]-=t,n[o]-=t}}Li(r,e,n)}Ai(t,e,n)}function Mi(t,n,r,i){for(const o of t){const t=new e.InternMap;let a=0;for(const s of o){let o=-1;const l=s.map((t=>Math.abs(r[t]-n[t]))),c=s.map((e=>{o=i?i[e]:++o;const a=r[e]-n[e],s=t.has(o)?a-t.get(o):0;return t.set(o,a),s})),u=[0,...e.cumsum(c)];for(const t of s)n[t]+=a,r[t]+=a;const f=e.sum(l);f&&(a-=e.sum(l,((t,e)=>(c[e]/2+u[e])*t))/f)}Li(o,n,r)}Ai(t,n,r)}function Li(t,n,r){const i=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=i,r[t]-=i}function Ai(t,n,r){const i=t.length;if(1===i)return;const o=t.map((t=>t.flat())),a=o.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),s=e.min(a);for(let t=0;t<i;t++){const e=s-a[t];for(const i of o[t])n[i]+=e,r[i]+=e}}function zi(t,e,n){return n}function Oi(t,e,n,r){return r}function Ri(t,n,r,i){return Pi(i,e.groupSort(q(t),(t=>e.sum(t,(t=>r[t]))),(t=>i[t])))}function Bi(t,n,r,i){return Pi(i,e.groupSort(q(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>i[t])))}function Ci(t,n,r,i){const o=q(t),a=e.groupSort(o,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>i[t])),s=e.rollup(o,(t=>e.sum(t,(t=>r[t]))),(t=>i[t])),l=[],c=[];let u=0;for(const t of a)u<0?(u+=s.get(t),l.push(t)):(u-=s.get(t),c.push(t));return Pi(i,c.reverse().concat(l))}function Ei(t){return e=>u(e,t)}function Pi(t,n){return n=new e.InternMap(n.map(((t,e)=>[t,e]))),t.map((t=>n.get(t)))}function Si(t,e){for(const n of t)n.sort(((t,n)=>mt(e[t],e[n])))}const Ni={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Ti extends Wr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,z:a,curve:s,tension:l}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"y1",value:r,scale:"y"},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0},{name:"z",value:D(e),optional:!0}],e,Ni),this.z=a,this.curve=Qr(s,l)}filter(t){return t}render(t,n,i,o,a){const{x1:s,y1:l,x2:c=s,y2:u=l}=i;return r("svg:g",a).call(Et,this,n,o).call(Tt,this,n,0,0).call((n=>n.selectAll().data(Ct(t,[s,l,c,u],this,i)).enter().append("path").call(Pt,this).call(Rt,this,i).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>s[t])).y0((t=>l[t])).x1((t=>c[t])).y1((t=>u[t]))))).node()}}function Di(t,e){const{x:n=h,...r}=ei(e);return new Ti(t,vi(pi({...r,x1:n,x2:void 0})))}function qi(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:i=e}={}){t.markerStart=Wi(n),t.markerMid=Wi(r),t.markerEnd=Wi(i)}function Wi(t){if(null==t||!1===t)return null;if(!0===t)return ji;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return Yi;case"dot":return _i;case"circle":case"circle-fill":return ji;case"circle-stroke":return Fi}throw new Error(`invalid marker: ${t}`)}function Yi(t,e){return r("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function _i(t,e){return r("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function ji(t,e){return r("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function Fi(t,e){return r("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let Ii=0;function Gi(t,e,{stroke:n}={}){return Ui(t,e,n&&(t=>n[t]))}function Xi(t,e,{stroke:n}={}){return Ui(t,e,n&&(([t])=>n[t]))}function Ui(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:i},o=(()=>i)){const a=new Map;function s(t){return function(e){const n=o(e);let r=a.get(t);r||a.set(t,r=new Map);let i=r.get(n);if(!i){const e={document:this.ownerDocument},o=this.parentNode.insertBefore(t(n,e),this),a="plot-marker-"+ ++Ii;o.setAttribute("id",a),r.set(n,i=`url(#${a})`)}return i}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}const Vi={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Hi extends Wr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,curve:a,tension:s}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"y1",value:r,scale:"y"},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0}],e,Vi),this.curve=Qr(a,s),qi(this,e)}render(t,n,i,o,a){const{x1:s,y1:l,x2:c=s,y2:u=l}=i,{curve:f}=this;return r("svg:g",a).call(Et,this,n,o).call(Tt,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(Pt,this).attr("d",(t=>{const n=e.path(),r=f(n);return r.lineStart(),r.point(s[t],l[t]),r.point(c[t],u[t]),r.lineEnd(),n})).call(Ot,this,i).call(Gi,this,i))).node()}}function Zi(t,{x:e,x1:n,x2:r,y:i,y1:o,y2:a,...s}={}){return[n,r]=Qi(e,n,r),[o,a]=Qi(i,o,a),new Hi(t,{...s,x1:n,x2:r,y1:o,y2:a})}function Qi(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Ji={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class Ki extends Wr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,bend:a=0,headAngle:s=60,headLength:l=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"y1",value:r,scale:"y"},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0}],e,Ji),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+s,this.headLength=+l,this.insetStart=+u,this.insetEnd=+f}render(t,e,n,i,o){const{x1:a,y1:s,x2:l=a,y2:c=s,SW:u}=n,{strokeWidth:f,bend:h,headAngle:d,headLength:p,insetStart:m,insetEnd:g}=this,y=u?t=>u[t]:b(void 0===f?1:f),v=h*dt,x=d*dt/2,w=p/1.5;return r("svg:g",o).call(Et,this,e,i).call(Tt,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(Pt,this).attr("d",(t=>{let e=a[t],n=s[t],r=l[t],i=c[t];const o=Math.hypot(r-e,i-n);if(o<=m+g)return null;let u=Math.atan2(i-n,r-e);const f=Math.min(w*y(t),o/3),h=Math.hypot(o/Math.tan(v),o)/2;if(m||g)if(h<1e5){const t=Math.sign(v),[o,a]=function([t,e],[n,r],i,o){const a=n-t,s=r-e,l=Math.hypot(a,s),c=o*Math.sqrt(i*i-l*l/4)/l;return[(t+n)/2-s*c,(e+r)/2+a*c]}([e,n],[r,i],h,t);if(m&&([e,n]=to([o,a,h],[e,n,m],-t*Math.sign(m))),g){const[e,n]=to([o,a,h],[r,i,g],t*Math.sign(g));u+=Math.atan2(n-a,e-o)-Math.atan2(i-a,r-o),r=e,i=n}}else{const t=r-e,o=i-n,a=Math.hypot(t,o);m&&(e+=t/a*m,n+=o/a*m),g&&(r-=t/a*g,i-=o/a*g)}const d=u+v,p=d+x,b=d-x,k=r-f*Math.cos(p),$=i-f*Math.sin(p),M=r-f*Math.cos(b),L=i-f*Math.sin(b);return`M${e},${n}${h<1e5?`A${h},${h} 0,0,${v>0?1:0} `:"L"}${r},${i}M${k},${$}L${r},${i}L${M},${L}`})).call(Ot,this,n))).node()}}function to([t,e,n],[r,i,o],a){const s=r-t,l=i-e,c=Math.hypot(s,l),u=(s*s+l*l-o*o+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(s*u+l*f)/c,e+(l*u-s*f)/c]}class eo extends Wr{constructor(t,e,n={},r){super(t,e,n,r);const{inset:i=0,insetTop:o=i,insetRight:a=i,insetBottom:s=i,insetLeft:l=i,rx:c,ry:u}=n;this.insetTop=y(o),this.insetRight=y(a),this.insetBottom=y(s),this.insetLeft=y(l),this.rx=Dt(c,"auto"),this.ry=Dt(u,"auto")}render(t,e,n,i,o){const{rx:a,ry:s}=this;return r("svg:g",o).call(Et,this,e,i).call(this._transform,this,e).call((r=>r.selectAll().data(t).enter().append("rect").call(Pt,this).attr("x",this._x(e,n,i)).attr("width",this._width(e,n,i)).attr("y",this._y(e,n,i)).attr("height",this._height(e,n,i)).call(Nt,"rx",a).call(Nt,"ry",s).call(Ot,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:i}){const{insetLeft:o,insetRight:a}=this,s=e&&t?t.bandwidth():i-n-r;return Math.max(0,s-o-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:i}){const{insetTop:o,insetBottom:a}=this,s=e&&t?t.bandwidth():i-n-r;return Math.max(0,s-o-a)}}const no={ariaLabel:"bar"};class ro extends eo{constructor(t,e={}){const{x1:n,x2:r,y:i}=e;super(t,[{name:"x1",value:n,scale:"x"},{name:"x2",value:r,scale:"x"},{name:"y",value:i,scale:"y",type:"band",optional:!0}],e,no)}_transform(t,e,{x:n}){t.call(Tt,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:i}=this;return Ln(t)?r+i:t=>Math.min(e[t],n[t])+i}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:i,width:o}){const{insetLeft:a,insetRight:s}=this;return Ln(t)?o-r-i-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}class io extends eo{constructor(t,e={}){const{x:n,y1:r,y2:i}=e;super(t,[{name:"y1",value:r,scale:"y"},{name:"y2",value:i,scale:"y"},{name:"x",value:n,scale:"x",type:"band",optional:!0}],e,no)}_transform(t,e,{y:n}){t.call(Tt,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:i}=this;return Ln(t)?r+i:t=>Math.min(e[t],n[t])+i}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:i,height:o}){const{insetTop:a,insetBottom:s}=this;return Ln(t)?o-r-i-a-s:t=>Math.max(0,Math.abs(n[t]-e[t])-a-s)}}function oo(t,e={y:h,x2:d}){return new ro(t,yi(Le(di(e))))}function ao(t,e={x:h,y2:d}){return new io(t,vi(Ae(pi(e))))}function so(t,e={}){return co(Object.fromEntries(["x","x1","x2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function lo(t,e={}){return co(Object.fromEntries(["y","y1","y2"].filter((t=>null!=e[t])).map((e=>[e,t]))),e)}function co(t={},n={}){const r=D(n),i=Object.entries(t).map((([t,e])=>{const r=j(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[i,o]=F(r);return{key:t,input:r,output:i,setOutput:o,map:uo(e)}}));return{...Wn(n,((t,n)=>{const o=u(t,r),a=i.map((({input:e})=>u(t,e))),s=i.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of o?e.group(t,(t=>o[t])).values():[t])i.forEach((({map:t},e)=>t.map(n,a[e],s[e])));return{data:t,facets:n}})),...Object.fromEntries(i.map((({key:t,output:e})=>[t,e])))}}function uo(t){if(t&&"function"==typeof t.map)return t;if("function"==typeof t)return ho(t);switch(`${t}`.toLowerCase()){case"cumsum":return po;case"rank":return ho(e.rank);case"quantile":return ho(fo)}throw new Error(`invalid map: ${t}`)}function fo(t){const n=e.count(t)-1;return e.rank(t).map((t=>t/n))}function ho(t){return{map(e,n,r){const i=t(Y(n,e));if(i.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=i[t]}}}const po={map(t,e,n){let r=0;for(const i of t)n[i]=r+=e[i]}},mo={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};class go extends Wr{constructor(t,n={}){const{x:r,y:i,r:o,rotate:a,symbol:s=e.symbolCircle,frameAnchor:l}=n,[c,u]=M(a,0),[f,h]=function(t){if(null==t||en(t))return[void 0,t];if("string"==typeof t){const e=tn.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[d,p]=M(o,null==f?3:4.5);super(t,[{name:"x",value:r,scale:"x",optional:!0},{name:"y",value:i,scale:"y",optional:!0},{name:"r",value:d,scale:"r",filter:xt,optional:!0},{name:"rotate",value:c,optional:!0},{name:"symbol",value:f,scale:"symbol",optional:!0}],void 0===n.sort&&void 0===n.reverse?Xn({channel:"r",order:"descending"},n):n,mo),this.r=p,this.rotate=u,this.symbol=h,this.frameAnchor=ot(l);const{channels:m}=this,g=m.find((({scale:t})=>"symbol"===t));if(g){const t=m.find((({name:t})=>"fill"===t)),e=m.find((({name:t})=>"stroke"===t));g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill,stroke:e?e.value===g.value?"color":"currentColor":this.stroke}}}render(t,n,i,o,a){const{x:s,y:l,r:c,rotate:u,symbol:f}=i,[h,d]=jt(this,o),p=this.symbol===e.symbolCircle;return r("svg:g",a).call(Et,this,n,o).call(Tt,this,n).call((n=>n.selectAll().data(t).enter().append(p?"circle":"path").call(Pt,this).call(p?t=>{t.attr("cx",s?t=>s[t]:h).attr("cy",l?t=>l[t]:d).attr("r",c?t=>c[t]:this.r)}:t=>{const n=s&&l?t=>`translate(${s[t]},${l[t]})`:s?t=>`translate(${s[t]},${d})`:l?t=>`translate(${h},${l[t]})`:()=>`translate(${h},${d})`;t.attr("transform",u?t=>`${n(t)} rotate(${u[t]})`:this.rotate?t=>`${n(t)} rotate(${this.rotate})`:n).attr("d",(t=>{const n=e.path(),r=c?c[t]:this.r;return(f?f[t]:this.symbol).draw(n,r*r*Math.PI),n}))}).call(Ot,this,i))).node()}}function yo(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=T(e,n)),new go(t,{...r,x:e,y:n})}const vo={ariaLabel:"rule",fill:null,stroke:"currentColor"};class xo extends Wr{constructor(t,e={}){const{x:n,y1:r,y2:i,inset:o=0,insetTop:a=o,insetBottom:s=o}=e;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y1",value:r,scale:"y",optional:!0},{name:"y2",value:i,scale:"y",optional:!0}],e,vo),this.insetTop=y(a),this.insetBottom=y(s)}render(t,e,n,i,o){const{x:a,y:s}=e,{x:l,y1:c,y2:u}=n,{width:f,height:h,marginTop:d,marginRight:p,marginLeft:m,marginBottom:g}=i,{insetTop:y,insetBottom:v}=this;return r("svg:g",o).call(Et,this,e,i).call(Tt,this,{x:l&&a},$t,0).call((e=>e.selectAll().data(t).enter().append("line").call(Pt,this).attr("x1",l?t=>l[t]:(m+f-p)/2).attr("x2",l?t=>l[t]:(m+f-p)/2).attr("y1",c&&!Ln(s)?t=>c[t]+y:d+y).attr("y2",u&&!Ln(s)?s.bandwidth?t=>u[t]+s.bandwidth()-v:t=>u[t]-v:h-g-v).call(Ot,this,n))).node()}}class wo extends Wr{constructor(t,e={}){const{x1:n,x2:r,y:i,inset:o=0,insetRight:a=o,insetLeft:s=o}=e;super(t,[{name:"y",value:i,scale:"y",optional:!0},{name:"x1",value:n,scale:"x",optional:!0},{name:"x2",value:r,scale:"x",optional:!0}],e,vo),this.insetRight=y(a),this.insetLeft=y(s)}render(t,e,n,i,o){const{x:a,y:s}=e,{y:l,x1:c,x2:u}=n,{width:f,height:h,marginTop:d,marginRight:p,marginLeft:m,marginBottom:g}=i,{insetLeft:y,insetRight:v}=this;return r("svg:g",o).call(Et,this,e,i).call(Tt,this,{y:l&&s},0,$t).call((e=>e.selectAll().data(t).enter().append("line").call(Pt,this).attr("x1",c&&!Ln(a)?t=>c[t]+y:m+y).attr("x2",u&&!Ln(a)?a.bandwidth?t=>u[t]+a.bandwidth()-v:t=>u[t]-v:f-p-v).attr("y1",l?t=>l[t]:(d+h-g)/2).attr("y2",l?t=>l[t]:(d+h-g)/2).call(Ot,this,n))).node()}}function bo(t,e){let{x:n=d,y:r,y1:i,y2:o,...a}=Ae(e);return[i,o]=$o(r,i,o),new xo(t,{...a,x:n,y1:i,y2:o})}function ko(t,e){let{y:n=d,x:r,x1:i,x2:o,...a}=Le(e);return[i,o]=$o(r,i,o),new wo(t,{...a,y:n,x1:i,x2:o})}function $o(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const Mo={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Lo extends Wr{constructor(t,e,n){super(t,e,n,Mo)}render(t,e,n,i,o){return r("svg:g",o).call(Et,this,e,i).call(this._transform,this,e).call((r=>r.selectAll().data(t).enter().append("line").call(Pt,this).attr("x1",this._x1(e,n,i)).attr("x2",this._x2(e,n,i)).attr("y1",this._y1(e,n,i)).attr("y2",this._y2(e,n,i)).call(Ot,this,n))).node()}}class Ao extends Lo{constructor(t,e={}){const{x:n,y:r,inset:i=0,insetTop:o=i,insetBottom:a=i}=e;super(t,[{name:"x",value:n,scale:"x"},{name:"y",value:r,scale:"y",type:"band",optional:!0}],e),this.insetTop=y(o),this.insetBottom=y(a)}_transform(t,e,{x:n}){t.call(Tt,e,{x:n},$t,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:i}=this;return e&&t?n=>e[n]+t.bandwidth()-i:n-r-i}}class zo extends Lo{constructor(t,e={}){const{x:n,y:r,inset:i=0,insetRight:o=i,insetLeft:a=i}=e;super(t,[{name:"y",value:r,scale:"y"},{name:"x",value:n,scale:"x",type:"band",optional:!0}],e),this.insetRight=y(o),this.insetLeft=y(a)}_transform(t,e,{y:n}){t.call(Tt,e,{y:n},0,$t)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:i}=this;return e&&t?n=>e[n]+t.bandwidth()-i:n-r-i}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function Oo(t,{x:e=d,...n}={}){return new Ao(t,{...n,x:e})}function Ro(t,{y:e=d,...n}={}){return new zo(t,{...n,y:e})}function Bo(t){const e=Co(t),n=Eo(t);return t.map((t=>t<e||t>n?t:NaN))}function Co(t,n){const r=2.5*Po(t,n)-1.5*So(t,n);return e.min(t,(t=>t>=r?t:NaN))}function Eo(t,n){const r=2.5*So(t,n)-1.5*Po(t,n);return e.max(t,(t=>t<=r?t:NaN))}function Po(t,n){return e.quantile(t,.25,n)}function So(t,n){return e.quantile(t,.75,n)}const No={ariaLabel:"cell"};class To extends eo{constructor(t,{x:e,y:n,...r}={}){super(t,[{name:"x",value:e,scale:"x",type:"band",optional:!0},{name:"y",value:n,scale:"y",type:"band",optional:!0}],r,No)}_transform(t,e){t.call(Tt,e,{},0,0)}}const Do={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},qo={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},Wo={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},Yo={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},_o={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class jo extends Wr{constructor(t,e={}){const{x:n,y:r,z:i,curve:o,tension:a}=e;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"z",value:i,optional:!0}],e,Do),this.curve=Qr(o,a),qi(this,e)}render(t,n,i,o,a){const{x:s,y:l,z:c}=i,{curve:u}=this,[f,h]=jt(this,o),d=s?t=>s[t]:b(f),p=l?t=>l[t]:b(h),m=this;function g(t){let n=-1;const r=[],o={};for(const t in i)o[t]=[];const a=[],s=[],l=[],c=[];function f(e,u){e=t[e],u=t[u],r.push(++n),a[n]=d(e),l[n]=p(e),s[n]=d(u),c[n]=p(u);for(const t in i)o[t].push(i[t][u])}const{halfedges:h,hull:g,triangles:y}=e.Delaunay.from(t,d,p);for(let t=0;t<h.length;++t){const e=h[t];e>t&&f(y[t],y[e])}for(let t=0;t<g.length;++t)f(g[t],g[(t+1)%g.length]);e.select(this).selectAll().data(r).join("path").call(Pt,m).attr("d",(t=>{const n=e.path(),r=u(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n})).call(Ot,m,o).call(Gi,m,o)}return r("svg:g",a).call(Et,this,n,o).call(Tt,this,n).call(c?n=>n.selectAll().data(e.group(t,(t=>c[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class Fo extends Wr{constructor(t,e={},n,r=(({z:t})=>t)){const{x:i,y:o}=e;super(t,[{name:"x",value:i,scale:"x",optional:!0},{name:"y",value:o,scale:"y",optional:!0},{name:"z",value:r(e),optional:!0}],e,n)}render(t,n,i,o,a){const{x:s,y:l,z:c}=i,[u,f]=jt(this,o),h=s?t=>s[t]:b(u),d=l?t=>l[t]:b(f),p=this;function m(t){const n=e.Delaunay.from(t,h,d);e.select(this).append("path").datum(t[0]).call(Pt,p).attr("d",p._render(n,o)).call(Ot,p,i)}return r("svg:g",a).call(Et,this,n,o).call(Tt,this,n).call(c?n=>n.selectAll().data(e.group(t,(t=>c[t])).values()).enter().append("g").each(m):e=>e.datum(t).each(m)).node()}}class Io extends Fo{constructor(t,e={}){super(t,e,qo),this.fill="none"}_render(t){return t.render()}}class Go extends Fo{constructor(t,e={}){super(t,e,Wo,D)}_render(t){return t.renderHull()}}class Xo extends Wr{constructor(t,e={}){const{x:n,y:r,z:i}=e;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"z",value:i,optional:!0}],e,Yo)}render(t,n,i,o,a){const{x:s,y:l,z:c}=i,[u,f]=jt(this,o),h=s?t=>s[t]:b(u),d=l?t=>l[t]:b(f);function p(t){const n=Vo(e.Delaunay.from(t,h,d),o);e.select(this).selectAll().data(t).enter().append("path").call(Pt,this).attr("d",((t,e)=>n.renderCell(e))).call(Ot,this,i)}return r("svg:g",a).call(Et,this,n,o).call(Tt,this,n).call(c?n=>n.selectAll().data(e.group(t,(t=>c[t])).values()).enter().append("g").each(p):e=>e.datum(t).each(p)).node()}}class Uo extends Fo{constructor(t,e){super(t,e,_o),this.fill="none"}_render(t,e){return Vo(t,e).render()}}function Vo(t,e){const{width:n,height:r,marginTop:i,marginRight:o,marginBottom:a,marginLeft:s}=e;return t.voronoi([s,i,n-o,r-a])}function Ho(t,e,{x:n,y:r,...i}={}){return[n,r]=T(n,r),new t(e,{...i,x:n,y:r})}const Zo={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Qo extends Wr{constructor(t,{x:n,y:r,z:i,weight:o,fill:a,stroke:s,...l}={}){const c=Ko(a)&&(a="currentColor",!0),f=Ko(s)&&(s="currentColor",!0);super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"z",value:D({z:i,fill:a,stroke:s}),optional:!0},{name:"weight",value:o,optional:!0}],function(t,n,r){const i=100;let{bandwidth:o,thresholds:a}=t;return o=void 0===o?20:+o,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?Rn(a):+a,Yn(t,(function(t,s,l,c,f){const h=l.x?Rn(u(l.x.value,c[l.x.scale]||d)):null,p=l.y?Rn(u(l.y.value,c[l.y.scale]||d)):null,m=l.weight?Rn(l.weight.value):null,g=l.z?.value,{z:y}=this,[v,x]=jt(this,f),{width:w,height:b}=f,k=Object.fromEntries(Object.entries(l).filter((([t])=>!Jo.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),$=n&&[],M=r&&[],L=e.contourDensity().x(h?t=>h[t]:v).y(p?t=>p[t]:x).weight(m?t=>m[t]:1).size([w,b]).bandwidth(o),A=[];for(const t of s){const e=[];A.push(e);for(const n of g?Bt(t,g,y):[t]){const t=L.contours(n);e.push([n,t])}}let z=a;if(!B(z)){let t=0;for(const e of A)for(const[,n]of e){const e=n.max;e>t&&(t=e)}z=Float64Array.from({length:a-1},((e,n)=>t*i*(n+1)/a))}const O=[],R=[];for(const t of A){const e=[];O.push(e);for(const[n,r]of t)for(const t of z){e.push(R.length),R.push(r(t/i)),$&&$.push(t),M&&M.push(t);for(const t in k)k[t].value.push(l[t].value[n[0]])}}return $&&$.push(0),M&&M.push(0),{data:t,facets:O,channels:{...k,...$&&{fill:{value:$,scale:"color"}},...M&&{stroke:{value:M,scale:"color"}},contours:{value:R}}}}))}({...l,fill:a,stroke:s},c,f),Zo),c&&(this.fill=void 0),f&&(this.stroke=void 0),this.z=i}filter(t){return t}render(t,n,r,i,o){const{contours:a}=r,s=e.geoPath();return e.create("svg:g",o).call(Et,this,n,i).call(Tt,this,n).call((e=>e.selectAll().data(t).enter().append("path").call(Pt,this).call(Ot,this,r).attr("d",(t=>s(a[t]))))).node()}}const Jo=new Set(["x","y","z","weight"]);function Ko(t){return/^density$/i.test(t)}const ta={ariaLabel:"frame",fill:"none",stroke:"currentColor"};class ea extends Wr{constructor(t={}){const{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e,rx:a,ry:s}=t;super(void 0,void 0,t,ta),this.insetTop=y(n),this.insetRight=y(r),this.insetBottom=y(i),this.insetLeft=y(o),this.rx=y(a),this.ry=y(s)}render(t,e,n,i,o){const{marginTop:a,marginRight:s,marginBottom:l,marginLeft:c,width:u,height:f}=i,{insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:g,ry:y}=this;return r("svg:rect",o).call(Et,this,e,i).call(Pt,this).call(Tt,this,{}).attr("x",c+m).attr("y",a+h).attr("width",u-c-s-m-d).attr("height",f-a-l-h-p).attr("rx",g).attr("ry",y).node()}}const na=.5;function ra(t,e,n,r){const i=r*(1.5/Qe),o=new Map;for(const a of t){let t=e[a],s=n[a];if(isNaN(t)||isNaN(s))continue;let l=Math.round(s=(s-0)/i),c=Math.round(t=(t-na)/r-(1&l)/2),u=s-l;if(3*Math.abs(u)>1){let e=t-c,n=c+(t<c?-1:1)/2,r=l+(s<l?-1:1),i=t-n,o=s-r;e*e+u*u>i*i+o*o&&(c=n+(1&l?1:-1)/2,l=r)}const f=`${c},${l}`;let h=o.get(f);void 0===h&&(o.set(f,h=[]),h.x=(c+(1&l)/2)*r+na,h.y=l*i+0),h.push(a)}return o.values()}const ia={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class oa extends Wr{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(void 0,void 0,{clip:e,...n},ia),this.binWidth=y(t)}render(t,e,n,i,o){const{binWidth:a}=this,{marginTop:s,marginRight:l,marginBottom:c,marginLeft:u,width:f,height:h}=i,d=u-na,p=f-l-na,m=s-0,g=h-c-0,y=a/2,v=y*Je,x=v/2,w=2*y,b=1.5*v,k=`m0,${-v}l${y},${x}v${v}l${-y},${x}`,$=Math.floor(d/w),M=Math.ceil(p/w),L=Math.floor((m+x)/b),A=Math.ceil((g-x)/b)+1,z=[];for(let t=L;t<A;++t)for(let e=$;e<M;++e)z.push(`M${e*w+(1&t)*y},${t*b}${k}`);return r("svg:g",o).call(Et,this,e,i).call((t=>t.append("path").call(Pt,this).call(Tt,this,{},$t+na,$t+0).attr("d",z.join("")))).node()}}const aa={ariaLabel:"image",fill:null,stroke:null};class sa extends Wr{constructor(t,e={}){let{x:n,y:r,width:i,height:o,src:a,preserveAspectRatio:s,crossOrigin:l,frameAnchor:c}=e;void 0===i&&void 0!==o?i=o:void 0===o&&void 0!==i&&(o=i);const[u,f]="string"==typeof(h=a)&&(function(t){return/^\.*\//.test(t)}(h)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(h))?[void 0,h]:[h,void 0];var h;const[d,p]=M(i,16),[m,y]=M(o,16);super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"width",value:d,filter:xt,optional:!0},{name:"height",value:m,filter:xt,optional:!0},{name:"src",value:u,optional:!0}],e,aa),this.src=f,this.width=p,this.height=y,this.preserveAspectRatio=Dt(s,"xMidYMid"),this.crossOrigin=g(l),this.frameAnchor=ot(c)}render(t,e,n,i,o){const{x:a,y:s,width:l,height:c,src:u}=n,[f,h]=jt(this,i);return r("svg:g",o).call(Et,this,e,i).call(Tt,this,e).call((e=>e.selectAll().data(t).enter().append("image").call(Pt,this).attr("x",l&&a?t=>a[t]-l[t]/2:l?t=>f-l[t]/2:a?t=>a[t]-this.width/2:f-this.width/2).attr("y",c&&s?t=>s[t]-c[t]/2:c?t=>h-c[t]/2:s?t=>s[t]-this.height/2:h-this.height/2).attr("width",l?t=>l[t]:this.width).attr("height",c?t=>c[t]:this.height).call(Nt,"href",u?t=>u[t]:this.src).call(Nt,"preserveAspectRatio",this.preserveAspectRatio).call(Nt,"crossorigin",this.crossOrigin).call(Ot,this,n))).node()}}const la={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class ca extends Wr{constructor(t,e={}){const{x:n,y:r,z:i,curve:o,tension:a}=e;super(t,[{name:"x",value:n,scale:"x"},{name:"y",value:r,scale:"y"},{name:"z",value:D(e),optional:!0}],e,la),this.z=i,this.curve=Qr(o,a),qi(this,e)}filter(t){return t}render(t,n,i,o,a){const{x:s,y:l}=i;return r("svg:g",a).call(Et,this,n,o).call(Tt,this,n).call((n=>n.selectAll().data(Ct(t,[s,l],this,i)).enter().append("path").call(Pt,this).call(Rt,this,i).call(Xi,this,i).attr("d",e.line().curve(this.curve).defined((t=>t>=0)).x((t=>s[t])).y((t=>l[t]))))).node()}}function ua(t,e,n){var r=0===t||1===t?0:Math.exp(ha(e+n)-ha(e)-ha(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*fa(t,e,n)/e:1-r*fa(1-t,n,e)/n)}function fa(t,e,n){var r,i,o,a,s=1e-30,l=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<s&&(d=s),a=d=1/d;l<=100&&(d=1+(i=l*(n-l)*t/((f+(r=2*l))*(e+r)))*d,Math.abs(d)<s&&(d=s),h=1+i/h,Math.abs(h)<s&&(h=s),a*=(d=1/d)*h,d=1+(i=-(e+l)*(c+l)*t/((e+r)*(u+r)))*d,Math.abs(d)<s&&(d=s),h=1+i/h,Math.abs(h)<s&&(h=s),a*=o=(d=1/d)*h,!(Math.abs(o-1)<3e-7));l++);return a}function ha(t){var e,n,r,i=0,o=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);i<6;i++)a+=o[i]/++n;return Math.log(2.506628274631*a/e)-r}function da(t,e){var n=function(t,e,n){var r,i,o,a,s,l,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(o=t<.5?t:1-t,l=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(o))))/(1+a*(.99229+.04481*a))-a,t<.5&&(l=-l),c=(l*l-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=l*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),l=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),i=Math.log(n/(e+n)),l=t<(a=Math.exp(e*r)/e)/(f=a+(s=Math.exp(n*i)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-ha(e)-ha(n)+ha(e+n);m<10;m++){if(0===l||1===l)return l;if((l-=a=(s=(ua(l,e,n)-t)/(a=Math.exp(d*Math.log(l)+p*Math.log(1-l)+h)))/(1-.5*Math.min(1,s*(d/l-p/(1-l)))))<=0&&(l=.5*(l+a)),l>=1&&(l=.5*(l+a+1)),Math.abs(a)<1e-8*l&&m>0)break}return l}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const pa={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class ma extends Wr{constructor(t,e={}){const{x:n,y:r,z:i,ci:o=.95,precision:a=4}=e;if(super(t,[{name:"x",value:n,scale:"x"},{name:"y",value:r,scale:"y"},{name:"z",value:D(e),optional:!0}],e,pa),this.z=i,this.ci=+o,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${o}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,i,o){const{x:a,y:s,z:l}=n,{ci:c}=this;return r("svg:g",o).call(Et,this,e,i).call(Tt,this,e).call((e=>e.selectAll().data(l?Bt(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(Pt,this).call(Rt,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,a,s))).call(c&&!it(this.fill)?t=>t.select(ga).attr("stroke","none").call(Pt,this).call(Rt,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,a,s))):()=>{}))))).node()}}function ga(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class ya extends ma{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:i,precision:o}=this,[a,s]=e.extent(t,(t=>r[t])),l=xa(t,r,n),c=wa(t,r,n,(1-i)/2,l);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,s-o/2,o).concat(s))}_renderLine(t,n,r){const[i,o]=e.extent(t,(t=>r[t])),a=xa(t,r,n);return`M${a(i)},${i}L${a(o)},${o}`}}class va extends ma{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:i,precision:o}=this,[a,s]=e.extent(t,(t=>n[t])),l=xa(t,n,r),c=wa(t,n,r,(1-i)/2,l);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,s-o/2,o).concat(s))}_renderLine(t,n,r){const[i,o]=e.extent(t,(t=>n[t])),a=xa(t,n,r);return`M${i},${a(i)}L${o},${a(o)}`}}function xa(t,e,n){let r=0,i=0,o=0,a=0;for(const s of t){const t=e[s],l=n[s];r+=t,i+=l,o+=t*l,a+=t*t}const s=t.length,l=(s*o-r*i)/(s*a-r*r),c=(i-l*r)/s;return t=>l*t+c}function wa(t,n,r,i,o){const a=e.sum(t,(t=>n[t]))/t.length;let s=0,l=0;for(const e of t)s+=(n[e]-a)**2,l+=(r[e]-o(n[e]))**2;const c=Math.sqrt(l/(t.length-2)),u=da(i,t.length-2);return(e,n)=>{const r=o(e),i=c*Math.sqrt(1/t.length+(e-a)**2/s);return r+n*u*i}}const ba={ariaLabel:"rect"};class ka extends Wr{constructor(t,e={}){const{x1:n,y1:r,x2:i,y2:o,inset:a=0,insetTop:s=a,insetRight:l=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,[{name:"x1",value:n,scale:"x",optional:!0},{name:"y1",value:r,scale:"y",optional:!0},{name:"x2",value:i,scale:"x",optional:!0},{name:"y2",value:o,scale:"y",optional:!0}],e,ba),this.insetTop=y(s),this.insetRight=y(l),this.insetBottom=y(c),this.insetLeft=y(u),this.rx=Dt(f,"auto"),this.ry=Dt(h,"auto")}render(t,e,n,i,o){const{x:a,y:s}=e,{x1:l,y1:c,x2:u,y2:f}=n,{marginTop:h,marginRight:d,marginBottom:p,marginLeft:m,width:g,height:y}=i,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this;return r("svg:g",o).call(Et,this,e,i).call(Tt,this,{x:l&&u?a:null,y:c&&f?s:null},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(Pt,this).attr("x",l&&u&&!Ln(a)?t=>Math.min(l[t],u[t])+b:m+b).attr("y",c&&f&&!Ln(s)?t=>Math.min(c[t],f[t])+v:h+v).attr("width",l&&u&&!Ln(a)?t=>Math.max(0,Math.abs(u[t]-l[t])-b-x):g-d-m-x-b).attr("height",c&&f&&!Ln(s)?t=>Math.max(0,Math.abs(c[t]-f[t])-v-w):y-h-p-v-w).call(Nt,"rx",k).call(Nt,"ry",$).call(Ot,this,n))).node()}}const $a={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"};class Ma extends Wr{constructor(t,e={}){const{x:n,y:r,text:i=(V(t)&&H(t)?d:h),frameAnchor:o,textAnchor:a=(/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle"),lineAnchor:s=(/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle"),lineHeight:l=1,lineWidth:c=1/0,monospace:f,fontFamily:p=(f?"ui-monospace, monospace":void 0),fontSize:m,fontStyle:y,fontVariant:v,fontWeight:x,rotate:w}=e,[b,k]=M(w,0),[$,L]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),Oa.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(m);var z;super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"fontSize",value:$,optional:!0},{name:"rotate",value:(z=b,null==z?null:{transform:t=>u(t,z,Float64Array),label:G(z)}),optional:!0},{name:"text",value:i,filter:yt}],e,$a),this.rotate=k,this.textAnchor=Dt(a,"middle"),this.lineAnchor=A(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+l,this.lineWidth=+c,this.monospace=!!f,this.fontFamily=g(p),this.fontSize=L,this.fontStyle=g(y),this.fontVariant=g(v),this.fontWeight=g(x),this.frameAnchor=ot(o)}render(t,e,n,i,o){const{x:a,y:s,rotate:l,text:c,fontSize:u}=n,{rotate:f}=this,[h,d]=jt(this,i);return r("svg:g",o).call(Et,this,e,i).call(za,this,c,i).call(Tt,this,e).call((e=>e.selectAll().data(t).enter().append("text").call(Pt,this).call(La,this,c).attr("transform",l?a&&s?t=>`translate(${a[t]},${s[t]}) rotate(${l[t]})`:a?t=>`translate(${a[t]},${d}) rotate(${l[t]})`:s?t=>`translate(${h},${s[t]}) rotate(${l[t]})`:t=>`translate(${h},${d}) rotate(${l[t]})`:f?a&&s?t=>`translate(${a[t]},${s[t]}) rotate(${f})`:a?t=>`translate(${a[t]},${d}) rotate(${f})`:s?t=>`translate(${h},${s[t]}) rotate(${f})`:`translate(${h},${d}) rotate(${f})`:a&&s?t=>`translate(${a[t]},${s[t]})`:a?t=>`translate(${a[t]},${d})`:s?t=>`translate(${h},${s[t]})`:`translate(${h},${d})`).call(Nt,"font-size",u&&(t=>u[t])).call(Ot,this,n))).node()}}function La(t,{monospace:n,lineAnchor:r,lineHeight:i,lineWidth:o},a){if(!a)return;const s=isFinite(o)?n?t=>Ra(t,o,Ea):t=>Ra(t,100*o,Ca):t=>t.split(/\r\n?|\n/g);t.each((function(t){const n=s(ht(a[t])),o=n.length,l="top"===r?.71:"bottom"===r?1-o:(164-100*o)/200;if(o>1)for(let t=0;t<o;++t){if(!n[t])continue;const r=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");r.setAttribute("x",0),r.setAttribute("y",(l+t)*i+"em"),r.textContent=n[t],this.appendChild(r)}else l&&this.setAttribute("y",l*i+"em"),this.textContent=n[0]}))}function Aa(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=T(e,n)),new Ma(t,{...r,x:e,y:n})}function za(t,e,n){Nt(t,"text-anchor",e.textAnchor),Nt(t,"font-family",e.fontFamily),Nt(t,"font-size",e.fontSize),Nt(t,"font-style",e.fontStyle),Nt(t,"font-variant",void 0===e.fontVariant&&(function(t){for(const e of t)if(null!=e)return"number"==typeof e}(n)||Q(n))?"tabular-nums":e.fontVariant),Nt(t,"font-weight",e.fontWeight)}const Oa=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Ra(t,e,n=((t,e,n)=>n-e)){const r=[];let i,o=0;for(const[a,s,l]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===i&&(i=a),o>i&&n(t,i,s)>e&&(r.push(t.slice(i,o)),i=a),l?(r.push(t.slice(i,s)),i=void 0):o=s;return r}const Ba={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47};function Ca(t,e,n){let r=0;for(let i=e;i<n;++i){r+=Ba[t[i]]||Ba.e;const e=t.charCodeAt(i);if(e>=55296&&e<=56319){const e=t.charCodeAt(i+1);e>=56320&&e<=57343&&++i}}return r}function Ea(t,e,n){return n-e}function Pa({path:t=d,delimiter:n,frameAnchor:r,treeLayout:i=e.tree,treeSort:o,treeSeparation:a,treeAnchor:s,...l}={}){s=Na(s),o=qa(o),void 0===r&&(r=s.frameAnchor);const c=Ya(n),f=ts(l,ja),[h,m]=F(),[g,y]=F();return{x:h,y:g,frameAnchor:r,...Wn(l,((n,r)=>{const l=c(u(n,t)),h=m([]),d=y([]);let g=-1;const v=[],x=[],w=e.stratify().path((t=>l[t])),b=i();b.nodeSize&&b.nodeSize([1,1]),b.separation&&void 0!==a&&b.separation(a??p);for(const t of f)t[Ka]=t[Qa]([]);for(const t of r){const e=[],r=w(t.filter((t=>null!=l[t]))).each((t=>t.data=n[t.data]));null!=o&&r.sort(o),b(r);for(const t of r.descendants()){e.push(++g),v[g]=t.data,s.position(t,g,h,d);for(const e of f)e[Ka][g]=e[Ja](t)}x.push(e)}return{data:v,facets:x}})),...Object.fromEntries(f)}}function Sa({path:t=d,delimiter:n,curve:r="bump-x",stroke:i="#555",strokeWidth:o=1.5,strokeOpacity:a=.5,treeLayout:s=e.tree,treeSort:l,treeSeparation:c,treeAnchor:f,...h}={}){f=Na(f),l=qa(l),h={curve:r,stroke:i,strokeWidth:o,strokeOpacity:a,...h};const m=Ya(n),g=ts(h,Fa),[y,v]=F(),[x,w]=F(),[b,k]=F(),[$,M]=F();return{x1:y,x2:x,y1:b,y2:$,...Wn(h,((n,r)=>{const i=m(u(n,t)),o=v([]),a=w([]),h=k([]),d=M([]);let y=-1;const x=[],b=[],$=e.stratify().path((t=>i[t])),L=s();L.nodeSize&&L.nodeSize([1,1]),L.separation&&void 0!==c&&L.separation(c??p);for(const t of g)t[Ka]=t[Qa]([]);for(const t of r){const e=[],r=$(t.filter((t=>null!=i[t]))).each((t=>t.data=n[t.data]));null!=l&&r.sort(l),L(r);for(const{source:t,target:n}of r.links()){e.push(++y),x[y]=n.data,f.position(t,y,o,h),f.position(n,y,a,d);for(const e of g)e[Ka][y]=e[Ja](n,t)}b.push(e)}return{data:x,facets:b}})),...Object.fromEntries(g)}}function Na(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return Ta;case"right":return Da}throw new Error(`invalid tree anchor: ${t}`)}const Ta={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,i){r[n]=e,i[n]=-t}},Da={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,i){r[n]=-e,i[n]=-t}};function qa(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?Wa(ja(t)):Wa(function(t){return e=>e.data?.[t]}(t))}function Wa(t){return(e,n)=>mt(t(e),t(n))}function Ya(t="/"){return"/"==`${t}`?t=>t:e=>{return e.map((n=t,r="/",n=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(n),"g"),t=>null==t?null:`${t}`.replace(n,r)));var n,r}}function _a(t){return C(t)&&"function"==typeof t.node}function ja(t){if(_a(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return Ga;case"node:path":return Ia;case"node:internal":return Va;case"node:depth":return Xa;case"node:height":return Ua}throw new Error(`invalid node value: ${t}`)}}function Fa(t){if(_a(t))return t.node;if(C(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return Ha(Ga);case"parent:path":return Ha(Ia);case"parent:depth":return Ha(Xa);case"parent:height":return Ha(Ua);case"node:name":return Ga;case"node:path":return Ia;case"node:internal":return Va;case"node:depth":return Xa;case"node:height":return Ua}throw new Error(`invalid link value: ${t}`)}}function Ia(t){return t.id}function Ga(t){return function(t){let e=t.length;for(;--e>0&&!Za(t,e););return t.slice(e+1)}(t.id)}function Xa(t){return t.depth}function Ua(t){return t.height}function Va(t){return!!t.children}function Ha(t){return(e,n)=>null==n?void 0:t(n)}function Za(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}const Qa=2,Ja=3,Ka=4;function ts(t,e){const n=[];for(const r in t){const i=t[r],o=e(i);void 0!==o&&n.push([r,...F(i),o])}return n}function es(t,{fill:e,stroke:n,strokeWidth:r,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:a,strokeMiterlimit:s,strokeDasharray:l,strokeDashoffset:c,marker:u,markerStart:f=u,markerEnd:h=u,dot:d=rt(f)&&rt(h),text:p="node:name",textStroke:m="white",title:g="node:path",dx:y,dy:v,...x}={}){return void 0===y&&(y=Na(x.treeAnchor).dx),Yr(Zi(t,Sa({markerStart:f,markerEnd:h,stroke:void 0!==n?n:void 0===e?"node:internal":e,strokeWidth:r,strokeOpacity:i,strokeLinejoin:o,strokeLinecap:a,strokeMiterlimit:s,strokeDasharray:l,strokeDashoffset:c,...x})),d?yo(t,Pa({fill:void 0===e?"node:internal":e,title:g,...x})):null,null!=p?Aa(t,Pa({text:p,fill:void 0===e?"currentColor":e,stroke:m,dx:y,dy:v,title:g,...x})):null)}const ns={ariaLabel:"vector",fill:null,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round"};class rs extends Wr{constructor(t,e={}){const{x:n,y:r,length:i,rotate:o,anchor:a="middle",frameAnchor:s}=e,[l,c]=M(i,12),[u,f]=M(o,0);super(t,[{name:"x",value:n,scale:"x",optional:!0},{name:"y",value:r,scale:"y",optional:!0},{name:"length",value:l,scale:"length",optional:!0},{name:"rotate",value:u,optional:!0}],e,ns),this.length=c,this.rotate=f,this.anchor=A(a,"anchor",["start","middle","end"]),this.frameAnchor=ot(s)}render(t,e,n,i,o){const{x:a,y:s,length:l,rotate:c}=n,{length:u,rotate:f,anchor:h}=this,[d,p]=jt(this,i),m=l?t=>l[t]:()=>u,g=c?t=>c[t]:()=>f,y=a?t=>a[t]:()=>d,v=s?t=>s[t]:()=>p,x="start"===h?0:"end"===h?1:.5;return r("svg:g",o).attr("fill","none").call(Et,this,e,i).call(Tt,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(Pt,this).attr("d",(t=>{const e=m(t),n=g(t)*dt,r=Math.sin(n)*e,i=-Math.cos(n)*e,o=(r+i)/5,a=(r-i)/5;return`M${y(t)-r*x},${v(t)-i*x}l${r},${i}m${-a},${-o}l${a},${o}l${-o},${a}`})).call(Ot,this,n))).node()}}function is(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>=0?(o=a,i=a-1):r=a+1}return o}function os(t,e,n,r,i){for(var o=i+1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)>0?(o=a,i=a-1):r=a+1}return o}function as(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<0?(o=a,r=a+1):i=a-1}return o}function ss(t,e,n,r,i){for(var o=r-1;r<=i;){var a=r+i>>>1,s=t[a];(void 0!==n?n(s,e):s-e)<=0?(o=a,r=a+1):i=a-1}return o}function ls(t,e,n,r,i){for(;r<=i;){var o=r+i>>>1,a=t[o],s=void 0!==n?n(a,e):a-e;if(0===s)return o;s<=0?r=o+1:i=o-1}return-1}function cs(t,e,n,r,i,o){return"function"==typeof n?o(t,e,n,void 0===r?0:0|r,void 0===i?t.length-1:0|i):o(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var us={ge:function(t,e,n,r,i){return cs(t,e,n,r,i,is)},gt:function(t,e,n,r,i){return cs(t,e,n,r,i,os)},lt:function(t,e,n,r,i){return cs(t,e,n,r,i,as)},le:function(t,e,n,r,i){return cs(t,e,n,r,i,ss)},eq:function(t,e,n,r,i){return cs(t,e,n,r,i,ls)}},fs=function(t){if(!t||0===t.length)return new Ls(null);return new Ls(Ms(t))};function hs(t,e,n,r,i){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=i,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var ds=hs.prototype;function ps(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function ms(t,e){var n=Ms(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function gs(t,e){var n=t.intervals([]);n.push(e),ms(t,n)}function ys(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),ms(t,n),1)}function vs(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var i=n(t[r]);if(i)return i}}function xs(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var i=n(t[r]);if(i)return i}}function ws(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function bs(t,e){return t-e}function ks(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function $s(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Ms(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(bs);var r=e[e.length>>1],i=[],o=[],a=[];for(n=0;n<t.length;++n){var s=t[n];s[1]<r?i.push(s):r<s[0]?o.push(s):a.push(s)}var l=a,c=a.slice();return l.sort(ks),c.sort($s),new hs(r,Ms(i),Ms(o),l,c)}function Ls(t){this.root=t}ds.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},ds.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?gs(this,t):this.left.insert(t):this.left=Ms([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?gs(this,t):this.right.insert(t):this.right=Ms([t]);else{var n=us.ge(this.leftPoints,t,ks),r=us.ge(this.rightPoints,t,$s);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},ds.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?ys(this,t):2===(o=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?ys(this,t):2===(o=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===o&&(this.count-=1),o):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var i=this.left,o=this.right;n.count-=r.count,n.right=r.left,r.left=i,r.right=o}ps(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?ps(this,this.left):ps(this,this.right);return 1}for(i=us.ge(this.leftPoints,t,ks);i<this.leftPoints.length&&this.leftPoints[i][0]===t[0];++i)if(this.leftPoints[i]===t){this.count-=1,this.leftPoints.splice(i,1);for(o=us.ge(this.rightPoints,t,$s);o<this.rightPoints.length&&this.rightPoints[o][1]===t[1];++o)if(this.rightPoints[o]===t)return this.rightPoints.splice(o,1),1}return 0},ds.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return vs(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return xs(this.rightPoints,t,e)}return ws(this.leftPoints,e)},ds.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?vs(this.leftPoints,e,n):t>this.mid?xs(this.rightPoints,t,n):ws(this.leftPoints,n)};var As=Ls.prototype;As.insert=function(t){this.root?this.root.insert(t):this.root=new hs(t[0],null,null,[t],[t])},As.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},As.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},As.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(As,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(As,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});const zs=({marginLeft:t})=>[1,t],Os=({width:t,marginRight:e})=>[-1,t-e],Rs=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],Bs=({marginTop:t})=>[1,t],Cs=({height:t,marginBottom:e})=>[-1,t-e],Es=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function Ps(t){return"string"==typeof t?{anchor:t}:t}function Ss(t){const{anchor:e,padding:n,...r}=t;return[{anchor:e,padding:n},r]}function Ns(t,e,n,r,i){const{r:o}=i;if(null!=o&&"number"!=typeof o){const{channels:t,sort:e,reverse:n}=i;i={...i,channels:[...t??[],{name:"r",value:o,scale:"r"}]},void 0===e&&void 0===n&&(i.sort={channel:"r",order:"descending"})}return Yn(i,(function(o,a,{[e]:s,r:l},c,f){if(!s)throw new Error(`missing channel: ${e}`);s=Rn(u(s.value,c[s.scale]||d));const h=l?void 0:void 0!==this.r?this.r:void 0!==i.r?y(i.r):3;l&&(l=Rn(u(l.value,c[l.scale]||d)));let[p,m]=n(f);const g=p?Ds:Ts,v=new Float64Array(s.length),x=l?t=>l[t]:()=>h;for(let t of a){const e=fs();t=t.filter(l?t=>vt(s[t])&&xt(l[t]):t=>vt(s[t]));const n=new Float64Array(2*t.length+2);for(const i of t){const t=x(i),o=p?t+r:0,a=s[i]-t,c=s[i]+t;let u=2;e.queryInterval(a-r,c+r,(([,,t])=>{const e=v[t]-o,a=s[i]-s[t],c=r+(l?l[i]+l[t]:2*h),f=Math.sqrt(c*c-a*a);n[u++]=e-f,n[u++]=e+f}));let f=n.slice(0,u);p&&(f=f.filter((t=>t>=0)));t:for(const t of f.sort(g)){for(let e=0;e<u;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;v[i]=t+o;break}e.insert([a,c,i])}}p||(p=1);for(const t of a)for(const e of t)v[e]=v[e]*p+m;return{data:o,facets:a,channels:{[e]:{value:s},[t]:{value:v},...l&&{r:{value:l}}}}}))}function Ts(t,e){return Math.abs(t)-Math.abs(e)}function Ds(t,e){return t-e}function qs(t){if(void 0===t)return js;if("function"==typeof t)return Ws(((e,n)=>t(Y(n,e))));if(/^p\d{2}$/i.test(t))return Ys(k(t));switch(`${t}`.toLowerCase()){case"deviation":return Is;case"first":return js;case"last":return Fs;case"max":return Gs;case"mean":return Xs;case"median":return Us;case"min":return Vs;case"sum":return Hs;case"extent":return _s}throw new Error(`invalid basis: ${t}`)}function Ws(t){return{map(e,n,r){const i=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/i}}}function Ys(t){return Ws(((e,n)=>t(e,(t=>n[t]))))}const _s={map(t,n,r){const[i,o]=e.extent(t,(t=>n[t])),a=o-i;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-i)/a}},js=Ws(((t,e)=>{for(let n=0;n<t.length;++n){const r=e[t[n]];if(pt(r))return r}})),Fs=Ws(((t,e)=>{for(let n=t.length-1;n>=0;--n){const r=e[t[n]];if(pt(r))return r}})),Is={map(t,n,r){const i=e.mean(t,(t=>n[t])),o=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:o?(n[e]-i)/o:0}},Gs=Ys(e.max),Xs=Ys(e.mean),Us=Ys(e.median),Vs=Ys(e.min),Hs=Ys(e.sum);function Zs(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:i,anchor:o}=t;if(void 0===o&&void 0!==i&&(o=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(i),kt(`Warning: the shift option is deprecated; please use anchor "${o}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return Qs(k(t));switch(t.toLowerCase()){case"deviation":return Qs(e.deviation);case"max":return Qs(e.max);case"mean":return Ks;case"median":return Qs(e.median);case"min":return Qs(e.min);case"mode":return Qs(e.mode);case"sum":return Js;case"variance":return Qs(e.variance);case"difference":return tl;case"ratio":return el;case"first":return nl;case"last":return rl}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return Qs(t)}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(o,n))}function Qs(t){return(e,n)=>({map(r,i,o){const a=Float64Array.from(r,(t=>null===i[t]?NaN:i[t]));let s=0;for(let t=0;t<e-1;++t)isNaN(a[t])&&++s;for(let i=0,l=r.length-e+1;i<l;++i)isNaN(a[i+e-1])&&++s,o[r[i+n]]=0===s?t(a.subarray(i,i+e)):NaN,isNaN(a[i])&&--s}})}function Js(t,e){return{map(n,r,i){let o=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++o:a+=+t}for(let s=0,l=n.length-t+1;s<l;++s){const l=r[n[s]],c=r[n[s+t-1]];null===c||isNaN(c)?++o:a+=+c,i[n[s+e]]=0===o?a:NaN,null===l||isNaN(l)?--o:a-=+l}}}}function Ks(t,e){const n=Js(t,e);return{map(r,i,o){n.map(r,i,o);for(let n=0,i=r.length-t+1;n<i;++n)o[r[n+e]]/=t}}}function tl(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s-a}}}}function el(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o){const a=r[n[o]],s=r[n[o+t-1]];i[n[o+e]]=null===a||null===s?NaN:s/a}}}}function nl(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o]]}}}function rl(t,e){return{map(n,r,i){for(let o=0,a=n.length-t;o<a;++o)i[n[o+e]]=r[n[o+t-1]]}}}function il(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return cl;case"max":return ul}throw new Error(`unknown selector: ${t}`)}function ol(t){return fl(null,sl,t)}function al(t){return fl(null,ll,t)}function*sl(t){yield t[0]}function*ll(t){yield t[t.length-1]}function*cl(t,n){yield e.least(t,(t=>n[t]))}function*ul(t,n){yield e.greatest(t,(t=>n[t]))}function fl(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const i=D(r);return Wn(r,((r,o)=>{const a=u(r,i),s=u(r,t),l=[];for(const t of o){const r=[];for(const i of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(i,s))r.push(t);l.push(r)}return{data:r,facets:l}}))}t.Area=Ti,t.Arrow=Ki,t.BarX=ro,t.BarY=io,t.Cell=To,t.Density=Qo,t.Dot=go,t.Frame=ea,t.Hexgrid=oa,t.Image=sa,t.Line=ca,t.Link=Hi,t.Mark=Wr,t.Rect=ka,t.RuleX=xo,t.RuleY=wo,t.Text=Ma,t.TickX=Ao,t.TickY=zo,t.Vector=rs,t.area=function(t,e){return void 0===e?Di(t,{x:x,y:w}):new Ti(t,e)},t.areaX=function(t,e){const{y:n=h,...r}=ni(e);return new Ti(t,yi(di({...r,y1:n,y2:void 0})))},t.areaY=Di,t.arrow=function(t,{x:e,x1:n,x2:r,y:i,y1:o,y2:a,...s}={}){return[n,r]=Qi(e,n,r),[o,a]=Qi(i,o,a),new Ki(t,{...s,x1:n,x2:r,y1:o,y2:a})},t.barX=oo,t.barY=ao,t.bin=function(t={fill:"count"},e={}){[t,e]=ii(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=oi(e,t),n=oi(n,t),[e.value,n.value]=T(e.value,n.value),{x:e,y:n}}(e);return ri(n,r,null,null,t,ge(ye(e)))},t.binX=Jr,t.binY=Kr,t.boxX=function(t,{x:e={transform:t=>t},y:n=null,fill:r="#ccc",fillOpacity:i,stroke:o="currentColor",strokeOpacity:a,strokeWidth:s=2,sort:l,...c}={}){const u=null!=n?Jn:Zn;return Yr(ko(t,u({x1:Co,x2:Eo},{x:e,y:n,stroke:o,strokeOpacity:a,...c})),oo(t,u({x1:"p25",x2:"p75"},{x:e,y:n,fill:r,fillOpacity:i,...c})),Oo(t,u({x:"p50"},{x:e,y:n,stroke:o,strokeOpacity:a,strokeWidth:s,sort:l,...c})),yo(t,co({x:Bo},{x:e,y:n,z:n,stroke:o,strokeOpacity:a,...c})))},t.boxY=function(t,{y:e={transform:t=>t},x:n=null,fill:r="#ccc",fillOpacity:i,stroke:o="currentColor",strokeOpacity:a,strokeWidth:s=2,sort:l,...c}={}){const u=null!=n?Qn:Zn;return Yr(bo(t,u({y1:Co,y2:Eo},{x:n,y:e,stroke:o,strokeOpacity:a,...c})),ao(t,u({y1:"p25",y2:"p75"},{x:n,y:e,fill:r,fillOpacity:i,...c})),Ro(t,u({y:"p50"},{x:n,y:e,stroke:o,strokeOpacity:a,strokeWidth:s,sort:l,...c})),yo(t,co({y:Bo},{x:n,y:e,z:n,stroke:o,strokeOpacity:a,...c})))},t.cell=function(t,{x:e,y:n,...r}={}){return[e,n]=T(e,n),new To(t,{...r,x:e,y:n})},t.cellX=function(t,{x:e=h,fill:n,stroke:r,...i}={}){return void 0===n&&void 0===$(r)[0]&&(n=d),new To(t,{...i,x:e,fill:n,stroke:r})},t.cellY=function(t,{y:e=h,fill:n,stroke:r,...i}={}){return void 0===n&&void 0===$(r)[0]&&(n=d),new To(t,{...i,y:e,fill:n,stroke:r})},t.circle=function(t,e){return yo(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return es(t,{...n,treeLayout:e.cluster})},t.column=F,t.delaunayLink=function(t,e){return Ho(jo,t,e)},t.delaunayMesh=function(t,e){return Ho(Io,t,e)},t.density=function(t,{x:e,y:n,...r}={}){return[e,n]=T(e,n),new Qo(t,{...r,x:e,y:n})},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=Ss(t));let{anchor:n="left",padding:r=1}=Ps(t);switch(`${n}`.toLowerCase()){case"left":n=zs;break;case"right":n=Os;break;case"middle":n=Rs;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Ns("x","y",n,y(r),e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=Ss(t));let{anchor:n="bottom",padding:r=1}=Ps(t);switch(`${n}`.toLowerCase()){case"top":n=Bs;break;case"bottom":n=Cs;break;case"middle":n=Es;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return Ns("y","x",n,y(r),e)},t.dot=yo,t.dotX=function(t,{x:e=d,...n}={}){return new go(t,Oe({...n,x:e}))},t.dotY=function(t,{y:e=d,...n}={}){return new go(t,ze({...n,y:e}))},t.filter=function(t,e){return Fn(e,In(t))},t.formatIsoDate=ft,t.formatMonth=function(t="en-US",e="short"){const n=ct(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=ut(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=function(t){return new ea(t)},t.group=function(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=T(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return Kn(n,r,t,e)},t.groupX=Qn,t.groupY=Jn,t.groupZ=Zn,t.hexagon=function(t,e){return yo(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},e={}){let{binWidth:n,...r}=e;n=void 0===n?20:y(n),t=er(t,r);const{z:i,fill:o,stroke:a}=r;return void 0===a&&rt(o)&&tr(t,"fill")&&(r.stroke="none"),void 0===r.symbol&&(r.symbol="hexagon"),void 0!==r.r||tr(t,"r")||(r.r=n/2),Yn(r,((e,r,{x:o,y:a,z:s,fill:l,stroke:c,symbol:f},h)=>{if(void 0===o)throw new Error("missing channel: x");if(void 0===a)throw new Error("missing channel: y");o=Rn(u(o.value,h[o.scale]||d)),a=Rn(u(a.value,h[a.scale]||d)),s=s?s.value:u(e,i),l=l?.value,c=c?.value,f=f?.value;const p=ar(t,{z:s,fill:l,stroke:c,symbol:f}),m=s&&[],g=l&&[],y=c&&[],v=f&&[],x=[],w=[],b=[];let k=-1;for(const n of t)n.initialize(e);for(const e of r){const r=[];for(const n of t)n.scope("facet",e);for(const[i,u]of ir(e,p))for(const e of ra(u,o,a,n)){r.push(++k),w.push(e.x),b.push(e.y),s&&m.push(p===s?i:s[e[0]]),l&&g.push(p===l?i:l[e[0]]),c&&y.push(p===c?i:c[e[0]]),f&&v.push(p===f?i:f[e[0]]);for(const n of t)n.reduce(e)}x.push(r)}return{data:e,facets:x,channels:{x:{value:w},y:{value:b},...s&&{z:{value:m}},...l&&{fill:{value:g,scale:!0}},...c&&{stroke:{value:y,scale:!0}},...f&&{symbol:{value:v,scale:!0}},...Object.fromEntries(t.map((({name:t,output:e})=>[t,{scale:!0,radius:"r"===t?n/2:void 0,value:e.transform()}])))}}}))},t.hexgrid=function(t){return new oa(t)},t.hull=function(t,e){return Ho(Go,t,e)},t.image=function(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=T(e,n)),new sa(t,{...r,x:e,y:n})},t.initializer=Yn,t.legend=function(t={}){for(const[e,r]of Sr){const i=t[e];if(E(i)){const o=n(t);let a;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&E(t.color)?"color":void 0)}=t;a={fill:e,stroke:n}}return r(yn(e,i,a),Nr(o,i,t),(e=>E(t[e])?yn(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=function(t,{x:e,y:n,...r}={}){return[e,n]=T(e,n),new ca(t,{...r,x:e,y:n})},t.lineX=function(t,{x:e=d,y:n=h,...r}={}){return new ca(t,ni({...r,x:e,y:n}))},t.lineY=function(t,{x:e=h,y:n=d,...r}={}){return new ca(t,ei({...r,x:e,y:n}))},t.linearRegressionX=function(t,{y:e=h,x:n=d,stroke:r,fill:i=(rt(r)?"currentColor":r),...o}={}){return new ya(t,ni({...o,x:n,y:e,fill:i,stroke:r}))},t.linearRegressionY=function(t,{x:e=h,y:n=d,stroke:r,fill:i=(rt(r)?"currentColor":r),...o}={}){return new va(t,ei({...o,x:e,y:n,fill:i,stroke:r}))},t.link=Zi,t.map=co,t.mapX=so,t.mapY=lo,t.marks=Yr,t.normalize=qs,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),so(qs(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),lo(qs(t),e)},t.plot=qr,t.rect=function(t,e){return new ka(t,$e(Me(e)))},t.rectX=function(t,e={y:h,interval:1,x2:d}){return new ka(t,yi(Me(di(e))))},t.rectY=function(t,e={x:h,interval:1,y2:d}){return new ka(t,vi($e(pi(e))))},t.reverse=function(t){return{...Fn(t,Gn),sort:null}},t.ruleX=bo,t.ruleY=ko,t.scale=function(t={}){let e;for(const n in t)if(re.has(n)&&E(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=En(yn(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return ol(e);case"last":return al(e)}if("function"==typeof t)return fl(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=il(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return fl(n,r,e)},t.selectFirst=ol,t.selectLast=al,t.selectMaxX=function(t){return fl("x",ul,t)},t.selectMaxY=function(t){return fl("y",ul,t)},t.selectMinX=function(t){return fl("x",cl,t)},t.selectMinY=function(t){return fl("y",cl,t)},t.shuffle=function({seed:t,...n}={}){return{...Fn(n,Hn(null==t?Math.random:e.randomLcg(t))),sort:null}},t.sort=Xn,t.stackX=mi,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=xi(t));const{y1:n,y:r=n,x:i}=e,[o,a,s]=wi(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=xi(t));const{y1:n,y:r=n,x:i}=e,[o,a,,s]=wi(r,i,"x",t,e);return{...o,y1:n,y:a,x:s}},t.stackY=gi,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=xi(t));const{x1:n,x:r=n,y:i}=e,[o,a,s]=wi(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=xi(t));const{x1:n,x:r=n,y:i}=e,[o,a,,s]=wi(r,i,"y",t,e);return{...o,x1:n,x:a,y:s}},t.text=Aa,t.textX=function(t,{x:e=d,...n}={}){return new Ma(t,Oe({...n,x:e}))},t.textY=function(t,{y:e=d,...n}={}){return new Ma(t,ze({...n,y:e}))},t.tickX=Oo,t.tickY=Ro,t.transform=Wn,t.tree=es,t.treeLink=Sa,t.treeNode=Pa,t.valueof=u,t.vector=function(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=T(e,n)),new rs(t,{...r,x:e,y:n})},t.vectorX=function(t,{x:e=d,...n}={}){return new rs(t,{...n,x:e})},t.vectorY=function(t,{y:e=d,...n}={}){return new rs(t,{...n,y:e})},t.version="0.5.2",t.voronoi=function(t,e){return Ho(Xo,t,e)},t.voronoiMesh=function(t,e){return Ho(Uo,t,e)},t.window=Zs,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),so(Zs(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),lo(Zs(t),e)},Object.defineProperty(t,"__esModule",{value:!0})}));
